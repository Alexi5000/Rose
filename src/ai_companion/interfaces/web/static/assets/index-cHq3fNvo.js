var e=Object.defineProperty,t=(t,n,r)=>((t,n,r)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r)(t,"symbol"!=typeof n?n+"":n,r);import{r as n,R as r,j as s,u as i,E as o,B as a,a as l,H as c,b as u,V as d,c as m,C as h,P as p,d as f}from"./r3f-D-aVanHc.js";import{m as g,c as y,h as x,Q as v,X as w,s as b,Y as j,z as S,Z as k,_ as E,u as C,d as R,v as M,t as N,$ as A,a0 as T,a1 as P}from"./three-SCLi_tbI.js";import{g as O,m as D,A as L,L as I}from"./animations-B_8wJt7L.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const F={uniforms:{time:{value:0},lightPosition:{value:new y(0,10,5)},baseColor:{value:new g("#4d9fff")},emissiveColor:{value:new g("#0a1e3d")},translucency:{value:.9},subsurfaceStrength:{value:.5},fresnelPower:{value:3},glowIntensity:{value:.3},refractionStrength:{value:.1}},vertexShader:"\n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec2 vUv;\n    \n    void main() {\n      vUv = uv;\n      vNormal = normalize(normalMatrix * normal);\n      vPosition = (modelMatrix * vec4(position, 1.0)).xyz;\n      \n      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n      vViewPosition = -mvPosition.xyz;\n      \n      gl_Position = projectionMatrix * mvPosition;\n    }\n  ",fragmentShader:"\n    uniform float time;\n    uniform vec3 lightPosition;\n    uniform vec3 baseColor;\n    uniform vec3 emissiveColor;\n    uniform float translucency;\n    uniform float subsurfaceStrength;\n    uniform float fresnelPower;\n    uniform float glowIntensity;\n    uniform float refractionStrength;\n    \n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying vec3 vViewPosition;\n    varying vec2 vUv;\n    \n    // Simple noise function for surface detail\n    float noise(vec2 st) {\n      return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\n    }\n    \n    void main() {\n      // Normalize vectors\n      vec3 normal = normalize(vNormal);\n      vec3 viewDir = normalize(vViewPosition);\n      vec3 lightDir = normalize(lightPosition - vPosition);\n      \n      // Fresnel effect for edge glow\n      float fresnel = pow(1.0 - max(0.0, dot(normal, viewDir)), fresnelPower);\n      \n      // Subsurface scattering approximation\n      // Light passing through the ice\n      float subsurface = max(0.0, dot(-lightDir, normal));\n      subsurface = pow(subsurface, 2.0) * subsurfaceStrength;\n      \n      // Add surface detail using noise\n      float surfaceNoise = noise(vUv * 10.0 + time * 0.1) * 0.1;\n      \n      // Combine base color with subsurface and fresnel\n      vec3 iceColor = baseColor;\n      iceColor += subsurface * vec3(0.3, 0.6, 1.0); // Blue subsurface tint\n      iceColor += fresnel * vec3(0.5, 0.8, 1.0) * glowIntensity; // Edge glow\n      \n      // Add emissive glow\n      vec3 emissive = emissiveColor * 0.2;\n      \n      // Final color\n      vec3 finalColor = iceColor + emissive + surfaceNoise;\n      \n      // Calculate opacity with fresnel for translucency\n      float alpha = mix(translucency, 1.0, fresnel * 0.5);\n      \n      gl_FragColor = vec4(finalColor, alpha);\n    }\n  "},z="#0a1e3d",U="#1e4d8b",_="#4d9fff",q="#ff8c42",B=768,H=1024,W=1440,G={mobile:{position:[0,2,12],fov:60},tablet:{position:[0,2,10],fov:55},desktop:{position:[0,2,8],fov:50},ultrawide:{position:[0,2,8],fov:45}},V={mobile:{shadows:!1,postProcessing:!1,particleCount:200,waterSubdivision:32},tablet:{shadows:!0,postProcessing:!0,particleCount:500,waterSubdivision:64},desktop:{shadows:!0,postProcessing:!0,particleCount:1e3,waterSubdivision:128}},K={high:{maxSize:2048,anisotropy:16,generateMipmaps:!0,minFilter:w,magFilter:x},medium:{maxSize:1024,anisotropy:8,generateMipmaps:!0,minFilter:w,magFilter:x},low:{maxSize:512,anisotropy:4,generateMipmaps:!0,minFilter:v,magFilter:x}},J=()=>{const[e,t]=n.useState("desktop"),[r,s]=n.useState(16/9);n.useEffect(()=>{const e=()=>{const e=window.innerWidth,n=window.innerHeight;s(e/n),t(e<B?"mobile":e<H?"tablet":e<W?"desktop":"ultrawide")};let n;e();const r=()=>{clearTimeout(n),n=window.setTimeout(e,100)};return window.addEventListener("resize",r),()=>{clearTimeout(n),window.removeEventListener("resize",r)}},[]);const i="ultrawide"===e?V.desktop:V[e],o=(a="tablet"===e,"mobile"===e?K.low:a?K.medium:K.high);var a;return{viewport:e,cameraConfig:G[e],quality:i,aspectRatio:r,isMobile:"mobile"===e,isTablet:"tablet"===e,isDesktop:"desktop"===e||"ultrawide"===e,isPortrait:r<1,isLandscape:r>=1,enablePostProcessing:i.postProcessing,enableShadows:i.shadows,particleCount:i.particleCount,waterSubdivision:i.waterSubdivision,textureQuality:o}},$="#0a1e3d",Z="#4d9fff",X="#ff8c42",Q="#ff6b9d",Y="#ff7a4d",ee="#6db8ff",te={ice:{color:Z,emissive:$,emissiveIntensity:.25,metalness:.05,roughness:.25},igloo:{color:X,emissive:Y,emissiveIntensity:.9,roughness:.75,metalness:0},rose:{color:"#16182a",emissive:Z,emissiveIntensity:.15,roughness:.95,metalness:.05},water:{color:"#0d2847",emissive:$,emissiveIntensity:.05,metalness:.95,roughness:.08}},ne={ambient:{color:Z,intensity:.35},key:{color:X,intensity:1.6,position:[0,3,-10],castShadow:!0,shadowConfig:{mapSize:2048,bias:-1e-4,normalBias:.02,radius:4}},rim:{color:ee,intensity:.9,position:[0,10,5]},fill:{color:ee,intensity:.6,position:[-5,3,2],distance:12,decay:2},iglooInterior:{color:X,intensity:2.2,distance:3.5,decay:2},iglooEntrance:{color:Y,intensity:.6,distance:1.8,decay:2}},re={sky:{colors:[{stop:0,color:$},{stop:.35,color:"#1e4d8b"},{stop:.65,color:Q},{stop:1,color:X}]}},se={intensity:.9,luminanceThreshold:.25,luminanceSmoothing:.95,radius:.85},ie={brightness:.08,contrast:1.15,saturation:1.25},oe={offset:.35,darkness:.45},ae={color:Q,near:25,far:90},le={color1:"#5da8ff",color2:"#a855ff",color3:"#52ffb8",baseIntensity:.65,maxIntensity:1.3},ce=e=>{e.frustumCulled=!0,e.traverse(e=>{e instanceof b&&(e.frustumCulled=!0,e.geometry&&(e.geometry.computeBoundingSphere(),e.geometry.computeBoundingBox()))})},ue=e=>{e&&(e.traverse(e=>{e instanceof b&&(e.geometry&&e.geometry.dispose(),e.material&&de(e.material)),e instanceof j&&e.dispose&&e.dispose()}),e.parent&&e.parent.remove(e))},de=e=>{(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(t=>{const n=e[t];n&&n instanceof S&&n.dispose()}),e.dispose()})},me=()=>{const e=n.useRef(null),t=n.useRef(null),r=n.useRef(null),o=n.useRef([]),a=n.useRef(null),l=n.useRef(null),{isMobile:c,isTablet:u}=J(),d=n.useMemo(()=>{const e=c?20:u?35:50,t=[];for(let n=0;n<e;n++){const r=n/e*20-10,s=5+2*Math.random(),i=2*Math.random()-5,o=.3+.7*Math.random(),a=.5+1.5*Math.random(),l=.2*Math.random()-.1,c=.3*Math.random()-.15,u=.2*Math.random()-.1;t.push({position:[r,s,i],rotation:[l,c,u],scale:[o,a,o]})}return t},[c,u]);n.useMemo(()=>{if(!e.current)return;const t=new k;d.forEach((n,r)=>{t.position.set(...n.position),t.rotation.set(...n.rotation),t.scale.set(...n.scale),t.updateMatrix(),e.current.setMatrixAt(r,t.matrix)}),e.current.instanceMatrix.needsUpdate=!0},[d]),i(t=>{const n=t.clock.elapsedTime;if(c||(r.current&&(r.current.uniforms.time.value=n),o.current.forEach(e=>{e&&(e.uniforms.time.value=n)})),e.current&&!c){const t=new k;d.forEach((r,s)=>{const i=.002*Math.sin(.5*n+.1*s),o=.002*Math.cos(.3*n+.15*s);t.position.set(r.position[0]+i,r.position[1],r.position[2]+o),t.rotation.set(...r.rotation),t.scale.set(...r.scale),t.updateMatrix(),e.current.setMatrixAt(s,t.matrix)}),e.current.instanceMatrix.needsUpdate=!0}});const m=c?6:8,h=n.useMemo(()=>(e=>(e.computeBoundingSphere(),e.computeBoundingBox(),e.attributes.normal||e.computeVertexNormals(),e))(new E(.1,1,m)),[m]);return n.useEffect(()=>{const n=e.current,r=t.current,s=h;return n&&ce(n),r&&ce(r),()=>{n&&ue(n),r&&ue(r),s&&s.dispose()}},[h]),s.jsxs("group",{name:"ice-cave-environment",children:[s.jsx("instancedMesh",{ref:e,args:[h,void 0,d.length],castShadow:!c,receiveShadow:!c,children:c?s.jsx("meshStandardMaterial",{color:te.ice.color,emissive:te.ice.emissive,emissiveIntensity:te.ice.emissiveIntensity,metalness:te.ice.metalness,roughness:te.ice.roughness,transparent:!0,opacity:.8}):s.jsx("shaderMaterial",{ref:r,uniforms:F.uniforms,vertexShader:F.vertexShader,fragmentShader:F.fragmentShader,transparent:!0,side:C})}),s.jsxs("group",{ref:t,name:"cave-walls",children:[s.jsxs("mesh",{position:[-8,2,-3],rotation:[0,.3,0],castShadow:!c,receiveShadow:!c,children:[s.jsx("cylinderGeometry",{args:[3,3,8,c?8:16,1,!0,0,.5*Math.PI]}),c?s.jsx("meshStandardMaterial",{color:te.ice.color,emissive:te.ice.emissive,emissiveIntensity:te.ice.emissiveIntensity,metalness:te.ice.metalness,roughness:te.ice.roughness,transparent:!0,opacity:.7,side:C}):s.jsx("shaderMaterial",{ref:e=>{e&&(o.current[0]=e)},uniforms:{...F.uniforms,translucency:{value:.7}},vertexShader:F.vertexShader,fragmentShader:F.fragmentShader,transparent:!0,side:C})]}),s.jsxs("mesh",{position:[8,2,-3],rotation:[0,-.3,0],castShadow:!c,receiveShadow:!c,children:[s.jsx("cylinderGeometry",{args:[3,3,8,c?8:16,1,!0,.5*Math.PI,.5*Math.PI]}),c?s.jsx("meshStandardMaterial",{color:te.ice.color,emissive:te.ice.emissive,emissiveIntensity:te.ice.emissiveIntensity,metalness:te.ice.metalness,roughness:te.ice.roughness,transparent:!0,opacity:.7,side:C}):s.jsx("shaderMaterial",{ref:e=>{e&&(o.current[1]=e)},uniforms:{...F.uniforms,translucency:{value:.7}},vertexShader:F.vertexShader,fragmentShader:F.fragmentShader,transparent:!0,side:C})]}),s.jsxs("mesh",{position:[0,6,-4],rotation:[.1*Math.PI,0,0],receiveShadow:!c,children:[s.jsx("planeGeometry",{args:[20,4,c?16:32,c?8:16]}),c?s.jsx("meshStandardMaterial",{color:te.ice.color,emissive:te.ice.emissive,emissiveIntensity:te.ice.emissiveIntensity,metalness:te.ice.metalness,roughness:te.ice.roughness,transparent:!0,opacity:.6,side:C}):s.jsx("shaderMaterial",{ref:e=>{e&&(o.current[2]=e)},uniforms:{...F.uniforms,translucency:{value:.6}},vertexShader:F.vertexShader,fragmentShader:F.fragmentShader,transparent:!0,side:C})]})]}),!c&&s.jsxs(s.Fragment,{children:[s.jsx(he,{ref:a,count:u?15:25}),s.jsx(pe,{ref:l,count:u?8:12})]})]})},he=r.forwardRef(({count:e},t)=>{const r=n.useMemo(()=>{const t=[];for(let n=0;n<e;n++){const r=n/e*Math.PI*2,s=3+4*Math.random(),i=Math.cos(r)*s+2*(Math.random()-.5),o=Math.sin(r)*s+2*(Math.random()-.5),a=.05,l=Math.random()*Math.PI*2,c=Math.random()*Math.PI*2,u=Math.random()*Math.PI*2,d=.05+.1*Math.random();t.push({position:[i,a,o],rotation:[l,c,u],scale:d})}return t},[e]);return n.useMemo(()=>{if(!t||"function"==typeof t||!t.current)return;const e=new k;r.forEach((n,r)=>{e.position.set(...n.position),e.rotation.set(...n.rotation),e.scale.setScalar(n.scale),e.updateMatrix(),t.current.setMatrixAt(r,e.matrix)}),t.current.instanceMatrix.needsUpdate=!0},[r,t]),s.jsxs("instancedMesh",{ref:t,args:[void 0,void 0,e],children:[s.jsx("octahedronGeometry",{args:[1,0]}),s.jsx("meshStandardMaterial",{color:te.ice.color,emissive:te.ice.emissive,emissiveIntensity:.5*te.ice.emissiveIntensity,metalness:te.ice.metalness,roughness:te.ice.roughness,transparent:!0,opacity:.7})]})});he.displayName="IceCrystals";const pe=r.forwardRef(({count:e},t)=>{const r=n.useMemo(()=>{const t=[];for(let n=0;n<e;n++){const e=3*(Math.random()-.5)-5,n=2*(Math.random()-.5)-1,r=.1,s=Math.random()*Math.PI*.3,i=Math.random()*Math.PI*2,o=Math.random()*Math.PI*.3,a=.15+.25*Math.random(),l=a*(.8+.4*Math.random()),c=a*(.6+.4*Math.random()),u=a*(.8+.4*Math.random());t.push({position:[e,r,n],rotation:[s,i,o],scale:[l,c,u]})}return t},[e]);return n.useMemo(()=>{if(!t||"function"==typeof t||!t.current)return;const e=new k;r.forEach((n,r)=>{e.position.set(...n.position),e.rotation.set(...n.rotation),e.scale.set(...n.scale),e.updateMatrix(),t.current.setMatrixAt(r,e.matrix)}),t.current.instanceMatrix.needsUpdate=!0},[r,t]),s.jsxs("instancedMesh",{ref:t,args:[void 0,void 0,e],receiveShadow:!0,castShadow:!0,children:[s.jsx("dodecahedronGeometry",{args:[1,0]}),s.jsx("meshStandardMaterial",{color:"#3a4a5a",roughness:.9,metalness:.1})]})});pe.displayName="Rocks";const fe={totalDuration:3.5,camera:{startZ:15,endZ:8,duration:3.5,ease:"power2.inOut",delay:0},rose:{startScale:0,endScale:1,duration:2.2,ease:"back.out(1.4)",delay:1},water:{startStrength:0,endStrength:.5,duration:2.5,ease:"power2.out",delay:1.2},aurora:{startIntensity:0,endIntensity:.65,duration:3.2,ease:"power1.inOut",delay:.8}},ge={amplitude:.02,frequency:.5},ye={amplitude:.05,frequency:.3},xe={amplitude:.02,frequency:.4},ve={sineAmplitude:.1,sineFrequency:3,randomAmplitude:.05},we={minSpeed:.008,maxSpeed:.018,driftAmplitude:.004,resetHeight:12,minHeight:-1},be={amplitudeMultiplier:1.8,transitionDuration:.25,ease:"power2.out"},je={baseIntensity:.15,maxBoost:.6},Se={maxPulse:.08},ke={pulseMultiplier:1.15},Ee=({audioAmplitude:e=0,animationScale:t=1,reducedMotion:r=!1})=>{const o=n.useRef(null),a=n.useRef(null),{isMobile:l}=J(),c=r?.3:1,u=l?8:16;return i(n=>{if(!o.current)return;const r=n.clock.elapsedTime,s=1+Math.sin(r*ge.frequency*Math.PI*2)*ge.amplitude*c,i=e*Se.maxPulse;o.current.scale.y=(s+i)*t,o.current.scale.x=(1+.5*i)*t,o.current.scale.z=(1+.5*i)*t;const a=Math.sin(r*ye.frequency*Math.PI*2)*ye.amplitude*c;o.current.position.y=.5+a;const l=Math.sin(r*xe.frequency*Math.PI*2)*xe.amplitude*c;o.current.rotation.z=l;const u=je.baseIntensity+e*je.maxBoost;o.current.traverse(e=>{if(e instanceof b&&e.material){const t=e.material;void 0!==t.emissiveIntensity&&(t.emissiveIntensity=u)}})}),s.jsxs("group",{ref:o,position:[0,.5,0],children:[s.jsxs("mesh",{ref:a,position:[0,0,0],castShadow:!l,children:[s.jsx("sphereGeometry",{args:[.3,u,u,0,2*Math.PI,0,.6*Math.PI]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[0,.4,0],castShadow:!l,children:[s.jsx("sphereGeometry",{args:[.15,u,u]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[.15,-.3,.1],rotation:[0,0,-.3],castShadow:!l,children:[s.jsx("cylinderGeometry",{args:[.08,.08,.4,u/2]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[-.15,-.3,.1],rotation:[0,0,.3],castShadow:!l,children:[s.jsx("cylinderGeometry",{args:[.08,.08,.4,u/2]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[.25,-.05,.15],rotation:[.5,0,.8],castShadow:!l,children:[s.jsx("cylinderGeometry",{args:[.06,.06,.35,u/2]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[-.25,-.05,.15],rotation:[.5,0,-.8],castShadow:!l,children:[s.jsx("cylinderGeometry",{args:[.06,.06,.35,u/2]}),s.jsx("meshStandardMaterial",{color:te.rose.color,emissive:te.rose.emissive,emissiveIntensity:te.rose.emissiveIntensity,roughness:te.rose.roughness,metalness:te.rose.metalness})]}),s.jsxs("mesh",{position:[0,0,0],children:[s.jsx("sphereGeometry",{args:[.6,u,u]}),s.jsx("meshBasicMaterial",{color:te.rose.emissive,transparent:!0,opacity:.06+.12*e})]})]})},Ce={uniforms:{time:{value:0},rippleCenter:{value:new R(.5,.5)},rippleStrength:{value:.5},skyColorTop:{value:new g("#0a1e3d")},skyColorHorizon:{value:new g("#ff8c42")},waterColorDeep:{value:new g("#0a1e3d")},waterColorShallow:{value:new g("#4d9fff")}},vertexShader:"\n    uniform float time;\n    uniform vec2 rippleCenter;\n    uniform float rippleStrength;\n    \n    varying vec2 vUv;\n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying float vElevation;\n    varying float vDistanceFromCenter;\n    \n    void main() {\n      vUv = uv;\n      vNormal = normal;\n      \n      // Calculate distance from ripple center (Rose's position)\n      vec2 centeredUv = uv - rippleCenter;\n      float dist = length(centeredUv);\n      vDistanceFromCenter = dist;\n      \n      // Create concentric ripples emanating from Rose's position\n      // Multiple frequencies for natural wave interference\n      float ripple1 = sin(dist * 20.0 - time * 2.0) * rippleStrength;\n      float ripple2 = sin(dist * 15.0 - time * 1.5) * rippleStrength * 0.5;\n      float ripple3 = sin(dist * 10.0 - time * 1.0) * rippleStrength * 0.3;\n      \n      // Smooth distance-based fade using exponential decay\n      // Ripples fade naturally as they move away from Rose\n      float fade = exp(-dist * 2.5);\n      float smoothFade = smoothstep(0.0, 0.1, fade) * fade;\n      \n      // Combine ripples with smooth fade\n      float totalRipple = (ripple1 + ripple2 + ripple3) * smoothFade;\n      \n      // Add subtle ambient wave motion for realism\n      float baseWave = sin(uv.x * 5.0 + time * 0.5) * 0.02;\n      baseWave += sin(uv.y * 3.0 + time * 0.3) * 0.02;\n      \n      // Displace vertices to create 3D ripple effect\n      vec3 newPosition = position;\n      newPosition.z += totalRipple * 0.15 + baseWave;\n      \n      vElevation = totalRipple * 0.15 + baseWave;\n      vPosition = newPosition;\n      \n      gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float time;\n    uniform vec3 skyColorTop;\n    uniform vec3 skyColorHorizon;\n    uniform vec3 waterColorDeep;\n    uniform vec3 waterColorShallow;\n    \n    varying vec2 vUv;\n    varying vec3 vNormal;\n    varying vec3 vPosition;\n    varying float vElevation;\n    varying float vDistanceFromCenter;\n    \n    void main() {\n      // Calculate view direction for Fresnel effect\n      vec3 viewDirection = normalize(cameraPosition - vPosition);\n      \n      // Fresnel effect - more reflection at grazing angles\n      float fresnel = pow(1.0 - dot(viewDirection, vec3(0.0, 0.0, 1.0)), 2.0);\n      \n      // Sky reflection gradient based on UV\n      vec3 skyReflection = mix(skyColorHorizon, skyColorTop, vUv.y);\n      \n      // Water color based on depth (elevation) and distance from center\n      float depthFactor = smoothstep(-0.1, 0.1, vElevation);\n      vec3 waterColor = mix(waterColorDeep, waterColorShallow, depthFactor);\n      \n      // Enhance color near ripple center (Rose's position)\n      float centerGlow = exp(-vDistanceFromCenter * 3.0) * 0.2;\n      waterColor = mix(waterColor, waterColorShallow, centerGlow);\n      \n      // Mix water color and sky reflection based on Fresnel\n      vec3 finalColor = mix(waterColor, skyReflection, fresnel * 0.6);\n      \n      // Add subtle shimmer effect\n      float shimmer = sin(vUv.x * 50.0 + time * 2.0) * sin(vUv.y * 50.0 + time * 1.5);\n      shimmer = shimmer * 0.05 + 0.95;\n      finalColor *= shimmer;\n      \n      // Add foam/highlights at wave peaks\n      float foam = smoothstep(0.08, 0.12, vElevation);\n      finalColor = mix(finalColor, vec3(1.0), foam * 0.3);\n      \n      // Slight transparency for realism\n      float alpha = 0.95 + fresnel * 0.05;\n      \n      gl_FragColor = vec4(finalColor, alpha);\n    }\n  "},Re=({rippleStrength:e=.5,rosePosition:t=[0,0],audioAmplitude:r=0})=>{const o=n.useRef(null),{viewport:a}=J(),l=n.useRef({value:e}),c=V[a]||V.desktop,u=n.useMemo(()=>new M({uniforms:{...Ce.uniforms,skyColorTop:{value:new g(z)},skyColorHorizon:{value:new g(q)},waterColorDeep:{value:new g(z)},waterColorShallow:{value:new g(_)}},vertexShader:Ce.vertexShader,fragmentShader:Ce.fragmentShader,transparent:!0,side:C}),[]);return n.useEffect(()=>{const t=e*(1+r*be.amplitudeMultiplier);O.to(l.current,{value:t,duration:be.transitionDuration,ease:be.ease})},[e,r]),i(e=>{if(o.current&&o.current.material instanceof M){const n=o.current.material;n.uniforms.time.value=e.clock.elapsedTime,n.uniforms.rippleStrength.value=l.current.value;const r=(t[0]+10)/20,s=(t[1]+10)/20;n.uniforms.rippleCenter.value.set(r,s)}}),s.jsxs("mesh",{ref:o,rotation:[-Math.PI/2,0,0],position:[0,0,0],receiveShadow:!0,children:[s.jsx("planeGeometry",{args:[20,20,c.waterSubdivision,c.waterSubdivision]}),s.jsx("primitive",{object:u,attach:"material"})]})},Me=({audioAmplitude:e=0})=>{const t=n.useRef(null),r=n.useRef(null),{isMobile:o}=J(),a=ne.iglooInterior.intensity;i(t=>{if(r.current){const n=t.clock.elapsedTime,s=1+Math.sin(n*ve.sineFrequency)*ve.sineAmplitude+(Math.random()-.5)*ve.randomAmplitude,i=1+e*(ke.pulseMultiplier-1);r.current.intensity=a*s*i}});const l=o?8:16;return s.jsxs("group",{ref:t,position:[-4,.8,-2],scale:.8,children:[s.jsxs("mesh",{castShadow:!o,receiveShadow:!o,children:[s.jsx("sphereGeometry",{args:[1,l,l,0,2*Math.PI,0,Math.PI/2]}),s.jsx("meshStandardMaterial",{color:te.igloo.color,emissive:te.igloo.emissive,emissiveIntensity:te.igloo.emissiveIntensity,roughness:te.igloo.roughness,metalness:te.igloo.metalness})]}),s.jsxs("mesh",{position:[.7,.2,0],rotation:[0,0,Math.PI/2],castShadow:!o,children:[s.jsx("cylinderGeometry",{args:[.3,.3,.6,l/2]}),s.jsx("meshStandardMaterial",{color:te.igloo.color,emissive:te.igloo.emissive,emissiveIntensity:.6*te.igloo.emissiveIntensity,roughness:te.igloo.roughness,metalness:te.igloo.metalness})]}),s.jsx("pointLight",{ref:r,position:[0,.4,0],color:ne.iglooInterior.color,intensity:a,distance:ne.iglooInterior.distance,decay:ne.iglooInterior.decay,castShadow:!1}),s.jsx("pointLight",{position:[.7,.2,0],color:ne.iglooEntrance.color,intensity:ne.iglooEntrance.intensity,distance:ne.iglooEntrance.distance,decay:ne.iglooEntrance.decay,castShadow:!1})]})},Ne={vertexShader:"\n    varying vec3 vWorldPosition;\n    \n    void main() {\n      vec4 worldPosition = modelMatrix * vec4(position, 1.0);\n      vWorldPosition = worldPosition.xyz;\n      \n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform vec3 topColor;\n    uniform vec3 midColor;\n    uniform vec3 horizonColor;\n    uniform vec3 bottomColor;\n    \n    varying vec3 vWorldPosition;\n    \n    void main() {\n      // Normalize Y position for gradient (-1 to 1)\n      float h = normalize(vWorldPosition).y;\n      \n      vec3 color;\n      \n      // Create smooth gradient with multiple color stops\n      // Using smoothstep for natural color blending (Requirement 9.3)\n      if (h > 0.4) {\n        // Top section: deep blue to sky blue\n        float t = smoothstep(0.4, 1.0, h);\n        color = mix(midColor, topColor, t);\n      } else if (h > 0.0) {\n        // Middle section: sky blue to warm pink\n        float t = smoothstep(0.0, 0.4, h);\n        color = mix(horizonColor, midColor, t);\n      } else {\n        // Bottom section: warm pink to warm orange\n        float t = smoothstep(-0.2, 0.0, h);\n        color = mix(bottomColor, horizonColor, t);\n      }\n      \n      gl_FragColor = vec4(color, 1.0);\n    }\n  "},Ae=()=>{const e=n.useMemo(()=>new M({uniforms:{topColor:{value:new g(re.sky.colors[0].color)},midColor:{value:new g(re.sky.colors[1].color)},horizonColor:{value:new g(re.sky.colors[2].color)},bottomColor:{value:new g(re.sky.colors[3].color)}},vertexShader:Ne.vertexShader,fragmentShader:Ne.fragmentShader,side:N,depthWrite:!1}),[]),t=n.useMemo(()=>new A({color:te.water.color,emissive:te.water.emissive,emissiveIntensity:te.water.emissiveIntensity,metalness:te.water.metalness,roughness:te.water.roughness,envMapIntensity:1.5}),[]),r=n.useMemo(()=>new g(ae.color),[]);return s.jsxs("group",{children:[s.jsx("mesh",{material:e,renderOrder:-1,children:s.jsx("sphereGeometry",{args:[500,32,32]})}),s.jsx("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-.5,-50],material:t,receiveShadow:!0,children:s.jsx("planeGeometry",{args:[1e3,1e3,1,1]})}),s.jsx("fog",{attach:"fog",args:[r,ae.near,ae.far]})]})},Te={uniforms:{time:{value:0},intensity:{value:.6},color1:{value:new g("#4d9fff")},color2:{value:new g("#9d4dff")},color3:{value:new g("#4dffaa")}},vertexShader:"\n    varying vec2 vUv;\n    varying vec3 vPosition;\n    \n    void main() {\n      vUv = uv;\n      vPosition = position;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ",fragmentShader:"\n    uniform float time;\n    uniform float intensity;\n    uniform vec3 color1; // Blue\n    uniform vec3 color2; // Purple\n    uniform vec3 color3; // Green\n    \n    varying vec2 vUv;\n    varying vec3 vPosition;\n    \n    \n  vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n  vec4 mod289(vec4 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }\n  vec4 permute(vec4 x) { return mod289(((x*34.0)+1.0)*x); }\n  vec4 taylorInvSqrt(vec4 r) { return 1.79284291400159 - 0.85373472095314 * r; }\n\n  float snoise(vec3 v) {\n    const vec2 C = vec2(1.0/6.0, 1.0/3.0);\n    const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);\n\n    vec3 i  = floor(v + dot(v, C.yyy));\n    vec3 x0 = v - i + dot(i, C.xxx);\n\n    vec3 g = step(x0.yzx, x0.xyz);\n    vec3 l = 1.0 - g;\n    vec3 i1 = min(g.xyz, l.zxy);\n    vec3 i2 = max(g.xyz, l.zxy);\n\n    vec3 x1 = x0 - i1 + C.xxx;\n    vec3 x2 = x0 - i2 + C.yyy;\n    vec3 x3 = x0 - D.yyy;\n\n    i = mod289(i);\n    vec4 p = permute(permute(permute(\n              i.z + vec4(0.0, i1.z, i2.z, 1.0))\n            + i.y + vec4(0.0, i1.y, i2.y, 1.0))\n            + i.x + vec4(0.0, i1.x, i2.x, 1.0));\n\n    float n_ = 0.142857142857;\n    vec3 ns = n_ * D.wyz - D.xzx;\n\n    vec4 j = p - 49.0 * floor(p * ns.z * ns.z);\n\n    vec4 x_ = floor(j * ns.z);\n    vec4 y_ = floor(j - 7.0 * x_);\n\n    vec4 x = x_ *ns.x + ns.yyyy;\n    vec4 y = y_ *ns.x + ns.yyyy;\n    vec4 h = 1.0 - abs(x) - abs(y);\n\n    vec4 b0 = vec4(x.xy, y.xy);\n    vec4 b1 = vec4(x.zw, y.zw);\n\n    vec4 s0 = floor(b0)*2.0 + 1.0;\n    vec4 s1 = floor(b1)*2.0 + 1.0;\n    vec4 sh = -step(h, vec4(0.0));\n\n    vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy;\n    vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww;\n\n    vec3 p0 = vec3(a0.xy, h.x);\n    vec3 p1 = vec3(a0.zw, h.y);\n    vec3 p2 = vec3(a1.xy, h.z);\n    vec3 p3 = vec3(a1.zw, h.w);\n\n    vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2,p2), dot(p3,p3)));\n    p0 *= norm.x;\n    p1 *= norm.y;\n    p2 *= norm.z;\n    p3 *= norm.w;\n\n    vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n    m = m * m;\n    return 42.0 * dot(m*m, vec4(dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3)));\n  }\n\n    \n    void main() {\n      // Create flowing noise patterns with multiple octaves\n      vec3 noiseCoord1 = vec3(vUv * 2.0, time * 0.1);\n      vec3 noiseCoord2 = vec3(vUv * 3.0, time * 0.15);\n      vec3 noiseCoord3 = vec3(vUv * 1.5, time * 0.08);\n      \n      float noise1 = snoise(noiseCoord1);\n      float noise2 = snoise(noiseCoord2);\n      float noise3 = snoise(noiseCoord3);\n      \n      // Combine noise layers for complex aurora pattern\n      float combinedNoise = noise1 * 0.5 + noise2 * 0.3 + noise3 * 0.2;\n      \n      // Create wave-like flowing motion\n      float wave = sin(vUv.x * 3.0 + time * 0.2) * 0.3;\n      wave += sin(vUv.y * 2.0 - time * 0.15) * 0.2;\n      \n      // Combine noise and waves\n      float aurora = combinedNoise + wave;\n      \n      // Apply smoothstep for ethereal edges\n      aurora = smoothstep(0.2, 0.8, aurora);\n      \n      // Create vertical gradient (stronger at top)\n      float verticalGradient = smoothstep(0.0, 0.5, vUv.y);\n      aurora *= verticalGradient;\n      \n      // Mix colors based on noise patterns\n      vec3 auroraColor = mix(color1, color2, noise1 * 0.5 + 0.5);\n      auroraColor = mix(auroraColor, color3, noise2 * 0.3 + 0.3);\n      \n      // Add subtle shimmer\n      float shimmer = sin(vUv.x * 20.0 + time * 2.0) * sin(vUv.y * 15.0 + time * 1.5);\n      shimmer = shimmer * 0.1 + 0.9;\n      auroraColor *= shimmer;\n      \n      // Apply intensity and create transparency\n      float alpha = aurora * intensity * 0.7;\n      \n      // Fade edges for seamless blending\n      float edgeFade = smoothstep(0.0, 0.1, vUv.x) * smoothstep(1.0, 0.9, vUv.x);\n      alpha *= edgeFade;\n      \n      gl_FragColor = vec4(auroraColor, alpha);\n    }\n  "},Pe=({audioAmplitude:e=0,baseIntensity:t=le.baseIntensity,reducedMotion:r=!1})=>{const o=n.useRef(null),{isMobile:a}=J(),l=r?.3:1,c=n.useMemo(()=>{const e=new M({uniforms:P.clone(Te.uniforms),vertexShader:Te.vertexShader,fragmentShader:Te.fragmentShader,transparent:!0,side:C,depthWrite:!1,blending:T});return e.uniforms.color1.value=new g(le.color1),e.uniforms.color2.value=new g(le.color2),e.uniforms.color3.value=new g(le.color3),e},[]);n.useEffect(()=>{if(!c)return;const n=t+e*(le.maxIntensity-le.baseIntensity);O.to(c.uniforms.intensity,{value:n,duration:.3,ease:"power2.out"})},[e,t,c]),i(e=>{c&&(c.uniforms.time.value=e.clock.elapsedTime*l)}),n.useEffect(()=>()=>{c.dispose()},[c]);const u=a?32:64,d=a?16:32;return s.jsxs("mesh",{ref:o,position:[0,8,-15],rotation:[-Math.PI/6,0,0],children:[s.jsx("planeGeometry",{args:[30,12,u,d]}),s.jsx("primitive",{object:c,attach:"material"})]})},Oe=({voiceState:e="idle",audioAmplitude:t=0})=>{const r=n.useRef(null),o=n.useRef(null),a=n.useRef(null),{quality:l}=J(),c=l.shadows,u={ambient:ne.ambient.intensity,key:ne.key.intensity,rim:ne.rim.intensity,fill:ne.fill.intensity};return i(()=>{if(!r.current||!o.current||!a.current)return;let n=1,s=0;switch(e){case"listening":n=1.1,o.current.intensity=1.2*u.rim;break;case"speaking":n=1.15,s=.2;const e=1+.15*t;r.current.intensity=u.key*n*e,a.current.intensity=u.fill*(1+s)*e;break;case"processing":n=1.05;break;default:return r.current.intensity=u.key,o.current.intensity=u.rim,void(a.current.intensity=u.fill)}"speaking"!==e&&(r.current.intensity=u.key*n,a.current.intensity=u.fill*(1+s))}),s.jsxs(s.Fragment,{children:[s.jsx("ambientLight",{color:ne.ambient.color,intensity:u.ambient}),s.jsx("directionalLight",{ref:r,position:ne.key.position,color:ne.key.color,intensity:u.key,castShadow:c&&ne.key.castShadow,"shadow-mapSize-width":ne.key.shadowConfig.mapSize,"shadow-mapSize-height":ne.key.shadowConfig.mapSize,"shadow-camera-far":50,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10,"shadow-bias":ne.key.shadowConfig.bias,"shadow-normalBias":ne.key.shadowConfig.normalBias,"shadow-radius":ne.key.shadowConfig.radius}),s.jsx("directionalLight",{ref:o,position:ne.rim.position,color:ne.rim.color,intensity:u.rim}),s.jsx("pointLight",{ref:a,position:ne.fill.position,color:ne.fill.color,intensity:u.fill,distance:ne.fill.distance,decay:ne.fill.decay})]})},De=({reducedMotion:e=!1})=>{const t=n.useRef(null),{quality:r}=J(),o=r.particleCount,a=e?Math.floor(.5*o):o,l=n.useMemo(()=>{const e=[],{minSpeed:t,maxSpeed:n,driftAmplitude:r,resetHeight:s}=we;for(let i=0;i<a;i++)e.push({position:new y(20*(Math.random()-.5),Math.random()*s,20*(Math.random()-.5)),velocity:new y(0,0,0),speed:t+Math.random()*(n-t),size:.02+.05*Math.random(),drift:(Math.random()-.5)*r});return e},[a]),c=n.useMemo(()=>new k,[]);return n.useEffect(()=>()=>{t.current&&ue(t.current)},[]),i(e=>{if(!t.current)return;const n=e.camera,{resetHeight:r,minHeight:s}=we;l.forEach((e,i)=>{e.position.y-=e.speed,e.position.x+=e.drift,e.position.y<s&&(e.position.y=r,e.position.x=20*(Math.random()-.5),e.position.z=20*(Math.random()-.5));const o=n.position.distanceTo(e.position),a=Math.max(0,1-o/15);c.position.copy(e.position),c.scale.setScalar(e.size*a),c.updateMatrix(),t.current.setMatrixAt(i,c.matrix)}),t.current.instanceMatrix.needsUpdate=!0}),s.jsxs("instancedMesh",{ref:t,args:[void 0,void 0,a],children:[s.jsx("sphereGeometry",{args:[1,8,8]}),s.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.6,blending:T,depthWrite:!1})]})},Le=({enabled:e=!0})=>{const{enablePostProcessing:t}=J();return t&&e?s.jsxs(o,{children:[s.jsx(a,{intensity:se.intensity,luminanceThreshold:se.luminanceThreshold,luminanceSmoothing:se.luminanceSmoothing,mipmapBlur:!0,radius:se.radius}),s.jsx(l,{brightness:ie.brightness,contrast:ie.contrast-1}),s.jsx(c,{saturation:ie.saturation-1,hue:0,blendFunction:u.NORMAL}),s.jsx(d,{offset:oe.offset,darkness:oe.darkness,eskil:!1,blendFunction:u.NORMAL})]}):null},Ie=(e={})=>{const{enabled:t=!0,duration:r=fe.totalDuration,onComplete:s}=e,i=n.useRef(null),o=n.useRef(!1),[a,l]=n.useState(fe.camera.startZ),[c,u]=n.useState(fe.rose.startScale),[d,m]=n.useState(fe.water.startStrength),[h,p]=n.useState(fe.aurora.startIntensity);n.useEffect(()=>{if(!t||o.current)return;const e=O.timeline({defaults:{ease:fe.camera.ease},onComplete:()=>{s&&s()}});return e.to({z:fe.camera.startZ},{z:fe.camera.endZ,duration:fe.camera.duration,ease:fe.camera.ease,onUpdate:function(){l(this.targets()[0].z)}},fe.camera.delay),e.to({scale:fe.rose.startScale},{scale:fe.rose.endScale,duration:fe.rose.duration,ease:fe.rose.ease,onUpdate:function(){u(this.targets()[0].scale)}},fe.rose.delay),e.to({strength:fe.water.startStrength},{strength:fe.water.endStrength,duration:fe.water.duration,ease:fe.water.ease,onUpdate:function(){m(this.targets()[0].strength)}},fe.water.delay),e.to({intensity:fe.aurora.startIntensity},{intensity:fe.aurora.endIntensity,duration:fe.aurora.duration,ease:fe.aurora.ease,onUpdate:function(){p(this.targets()[0].intensity)}},fe.aurora.delay),i.current=e,o.current=!0,()=>{i.current&&(i.current.kill(),i.current=null)}},[t,r,s]);return{cameraZ:a,roseScale:c,waterRippleStrength:d,auroraIntensity:h,timeline:i.current,play:()=>{i.current&&i.current.play()},pause:()=>{i.current&&i.current.pause()},restart:()=>{i.current&&(o.current=!1,i.current.restart())},reverse:()=>{i.current&&i.current.reverse()},skip:()=>{i.current&&i.current.progress(1)},isAnimating:i.current?.isActive()??!1,hasPlayed:o.current}},Fe=({audioAmplitude:e,voiceState:t,enableEntryAnimation:r,reducedMotion:o,cameraConfig:a,isMobile:l})=>{const{qualityLevel:c,isPerformanceGood:u}=((e={})=>{const{targetFPS:t=60,enableAdaptiveQuality:r=!0,logInterval:s=5e3,onPerformanceChange:o}=e,{gl:a}=m(),[l,c]=n.useState({fps:60,frameTime:16.67,drawCalls:0,triangles:0,geometries:0,textures:0,programs:0}),[u,d]=n.useState("high"),[h,p]=n.useState(!0),f=n.useRef([]),g=n.useRef(0),y=n.useRef(0),x=n.useCallback(e=>{if(0===e.length)return 60;const t=e.reduce((e,t)=>e+t,0)/e.length;return Math.round(1e3/t)},[]),v=n.useCallback(()=>{const e=a.info;return{drawCalls:e.render.calls,triangles:e.render.triangles,geometries:e.memory.geometries,textures:e.memory.textures,programs:e.programs?.length||0,memory:{geometries:e.memory.geometries,textures:e.memory.textures}}},[a]),w=n.useCallback(e=>e>=.8*t?"high":e>=.5*t?"medium":"low",[t]);return i((e,n)=>{const i=performance.now(),a=1e3*n;if(f.current.push(a),f.current.length>60&&f.current.shift(),s>0&&i-g.current>=s){const e=x(f.current),n=f.current.reduce((e,t)=>e+t,0)/f.current.length,s=v(),a={fps:e,frameTime:n,drawCalls:s.drawCalls||0,triangles:s.triangles||0,geometries:s.geometries||0,textures:s.textures||0,programs:s.programs||0,memory:s.memory};if(c(a),p(e>=.8*t),r){const t=w(e);t!==u&&d(t)}o?.(a),g.current=i}y.current=i}),n.useEffect(()=>()=>{a.info.reset()},[a]),{metrics:l,qualityLevel:u,isPerformanceGood:h,targetFPS:t}})({targetFPS:l?30:60,enableAdaptiveQuality:!0,logInterval:5e3,onPerformanceChange:e=>{}}),{cameraZ:d,roseScale:h,waterRippleStrength:f,auroraIntensity:g,isAnimating:y}=Ie({enabled:r,duration:3,onComplete:()=>{}}),x=y?d:a.position[2];return s.jsxs(s.Fragment,{children:[s.jsx(p,{makeDefault:!0,position:[a.position[0],a.position[1],x],fov:a.fov,near:.1,far:1e3}),s.jsxs(n.Suspense,{fallback:null,children:[s.jsx(Oe,{voiceState:t,audioAmplitude:e}),s.jsx(me,{}),s.jsx(Ee,{audioAmplitude:e,animationScale:h,reducedMotion:o}),s.jsx(Re,{audioAmplitude:e,rosePosition:[0,0],rippleStrength:f}),s.jsx(Me,{audioAmplitude:e}),s.jsx(Ae,{}),s.jsx(Pe,{audioAmplitude:e,baseIntensity:g,reducedMotion:o}),s.jsx(De,{reducedMotion:o}),s.jsx(Le,{enabled:!o&&"low"!==c})]})]})},ze=({audioAmplitude:e=0,voiceState:t="idle",enableEntryAnimation:n=!0,reducedMotion:r=!1})=>{const{cameraConfig:i,isMobile:o}=J();return s.jsx(h,{gl:{antialias:!0,alpha:!1,powerPreference:"high-performance"},dpr:o?[1,1.5]:[1,2],shadows:!0,style:{touchAction:"none"},frameloop:"always",children:s.jsx(Fe,{audioAmplitude:e,voiceState:t,enableEntryAnimation:n,reducedMotion:r,cameraConfig:i,isMobile:o})})},Ue=()=>s.jsx(D.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:1.5,ease:"easeOut",delay:.5},className:"absolute top-8 sm:top-12 left-1/2 -translate-x-1/2 z-10 pointer-events-none px-4",children:s.jsxs("h1",{className:"text-white text-center select-none",children:[s.jsx("div",{className:"text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-light tracking-[0.25em] sm:tracking-[0.3em] mb-1 sm:mb-2 drop-shadow-lg",children:"ROSE"}),s.jsx("div",{className:"text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-light tracking-[0.15em] sm:tracking-[0.2em] opacity-90 drop-shadow-md",children:"THE HEALER SHAMAN"})]})}),_e=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},qe=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim(),Be=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var He={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=n.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:a,...l},c)=>n.createElement("svg",{ref:c,...He,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:qe("lucide",i),...!o&&!Be(l)&&{"aria-hidden":"true"},...l},[...a.map(([e,t])=>n.createElement(e,t)),...Array.isArray(o)?o:[o]])),Ge=(e,t)=>{const r=n.forwardRef(({className:r,...s},i)=>{return n.createElement(We,{ref:i,iconNode:t,className:qe(`lucide-${o=_e(e),o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...s});var o});return r.displayName=_e(e),r},Ve=Ge("accessibility",[["circle",{cx:"16",cy:"4",r:"1",key:"1grugj"}],["path",{d:"m18 19 1-7-6 1",key:"r0i19z"}],["path",{d:"m5 8 3-3 5.5 3-2.36 3.5",key:"9ptxx2"}],["path",{d:"M4.24 14.5a5 5 0 0 0 6.88 6",key:"10kmtu"}],["path",{d:"M13.76 17.5a5 5 0 0 0-6.88-6",key:"2qq6rc"}]]),Ke=Ge("keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]),Je=Ge("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),$e=Ge("mic-off",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M16.95 16.95A7 7 0 0 1 5 12v-2",key:"cqa7eg"}],["path",{d:"M18.89 13.23A7 7 0 0 0 19 12v-2",key:"16hl24"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}]]),Ze=Ge("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),Xe=Ge("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Qe=Ge("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Ye=Ge("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),et=Ge("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),tt=Ge("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),nt=Ge("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),rt=Ge("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),st=(e=10)=>{"vibrate"in navigator&&navigator.vibrate(e)},it={idle:{scale:1,boxShadow:"0 0 20px rgba(77, 159, 255, 0.4)",transition:{duration:.3,ease:"easeOut"}},listening:{scale:1.1,boxShadow:"0 0 40px rgba(77, 159, 255, 0.8)",transition:{duration:.3,ease:"easeOut"}},processing:{scale:1.05,boxShadow:"0 0 30px rgba(157, 77, 255, 0.6)",transition:{duration:.3,ease:"easeInOut"}},speaking:{scale:[1,1.05,1],boxShadow:"0 0 30px rgba(255, 140, 66, 0.6)",transition:{repeat:1/0,duration:1,ease:"easeInOut"}}},ot={scale:1.05,transition:{duration:.2,ease:"easeOut"}},at={scale:.95,transition:{duration:.1,ease:"easeIn"}},lt=({voiceState:e,onStartRecording:t,onStopRecording:n,disabled:r=!1,audioAmplitude:i=0})=>{const o=()=>{"listening"===e&&n()},a="speaking"===e?1+.1*i:1;return s.jsxs("div",{className:"absolute bottom-20 left-1/2 -translate-x-1/2 z-10",children:["listening"===e&&s.jsxs(s.Fragment,{children:[s.jsx(D.div,{className:"absolute inset-0 rounded-full border-2 border-blue-400/50",initial:{scale:1,opacity:.8},animate:{scale:2,opacity:0},transition:{duration:1.5,repeat:1/0,ease:"easeOut"},style:{width:"80px",height:"80px",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),s.jsx(D.div,{className:"absolute inset-0 rounded-full border-2 border-blue-400/30",initial:{scale:1,opacity:.6},animate:{scale:2.5,opacity:0},transition:{duration:2,repeat:1/0,ease:"easeOut",delay:.5},style:{width:"80px",height:"80px",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}})]}),"idle"===e&&s.jsx(D.div,{className:"absolute inset-0 rounded-full bg-blue-400/20 blur-xl",animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},style:{width:"100px",height:"100px",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}}),s.jsxs(D.button,{className:"relative focus:outline-none focus-visible:ring-4 focus-visible:ring-blue-400/70 rounded-full touch-none select-none",variants:it,animate:e,style:{scale:a,WebkitTapHighlightColor:"transparent",WebkitTouchCallout:"none"},whileHover:"idle"===e?ot:void 0,whileTap:"idle"===e?at:void 0,onMouseDown:()=>{r||"idle"!==e||t()},onMouseUp:o,onMouseLeave:o,onTouchStart:n=>{n.preventDefault(),r||"idle"!==e||(st(10),t())},onTouchEnd:t=>{t.preventDefault(),"listening"===e&&(st(10),n())},onTouchCancel:t=>{t.preventDefault(),"listening"===e&&n()},onKeyDown:s=>{" "===s.key||"Enter"===s.key?(s.preventDefault(),r||"idle"!==e||t()):"Escape"===s.key&&(s.preventDefault(),"listening"===e&&n())},onKeyUp:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),"listening"===e&&n())},disabled:r||"processing"===e||"speaking"===e,"aria-label":(()=>{switch(e){case"listening":return"Recording your voice. Release to send.";case"processing":return"Processing your message...";case"speaking":return"Rose is responding...";default:return"Press and hold to speak with Rose"}})(),"aria-pressed":"listening"===e,role:"button",tabIndex:0,children:[s.jsx(D.div,{className:"w-20 h-20 rounded-full bg-white/10 backdrop-blur-md\r\n                     border-2 border-white/30 flex items-center justify-center",animate:{borderColor:"listening"===e?"rgba(77, 159, 255, 0.6)":"speaking"===e?"rgba(255, 140, 66, 0.6)":"rgba(255, 255, 255, 0.3)",backgroundColor:"listening"===e?"rgba(77, 159, 255, 0.15)":"speaking"===e?"rgba(255, 140, 66, 0.15)":"rgba(255, 255, 255, 0.1)"},transition:{duration:.3,ease:"easeInOut"},children:(()=>{switch(e){case"listening":case"speaking":return s.jsx(Ze,{className:"w-8 h-8 text-white"});case"processing":return s.jsx(Je,{className:"w-8 h-8 text-white animate-spin"});default:return s.jsx($e,{className:"w-8 h-8 text-white/80"})}})()}),s.jsxs("span",{className:"sr-only","aria-live":"polite","aria-atomic":"true",children:["processing"===e&&"Processing your message...","speaking"===e&&"Rose is responding..."]})]})]})},ct=({isLoading:e,progress:t=0,currentAsset:n,phase:r})=>{const i=((e,t)=>{if(!e)return"critical"===t?"🎨":"secondary"===t?"🎭":"effects"===t?"✨":"📦";const n=e.split(".").pop()?.toLowerCase();return"css"===n?"🎨":"glb"===n||"gltf"===n||"jpg"===n||"png"===n||"webp"===n?"🎭":"mp3"===n||"wav"===n||"ogg"===n?"🎵":"📦"})(n,r),o=(e=>"critical"===e?"Loading essential elements":"secondary"===e?"Loading environmental details":"effects"===e?"Preparing visual effects":"complete"===e?"Ready":"Entering the sanctuary")(r),a=(l=n)?(l.split("/").pop()||"").split(".")[0].replace(/[-_]/g," ").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"";var l;return s.jsx(L,{children:e&&s.jsx(D.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:1,ease:"easeInOut"},className:"fixed inset-0 z-50 flex items-center justify-center",style:{background:`linear-gradient(to bottom, ${z} 0%, ${U} 100%)`},children:s.jsxs("div",{className:"text-center px-4 max-w-md",children:[s.jsx(D.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:2,ease:"easeInOut"},className:"flex justify-center mb-6",children:s.jsx(Je,{className:"w-12 h-12 text-white/60 animate-spin"})}),s.jsx(D.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.8},className:"text-white/60 text-sm tracking-wide mb-2",children:o}),a&&s.jsxs(D.p,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},exit:{opacity:0,y:-5},transition:{duration:.3},className:"text-white/40 text-xs tracking-wide mb-6 flex items-center justify-center gap-2",children:[s.jsx("span",{className:"text-base",children:i}),s.jsx("span",{children:a})]},n),s.jsx(D.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5,duration:.8},className:"w-64 h-1 bg-white/10 rounded-full overflow-hidden mx-auto",children:s.jsx(D.div,{className:"h-full bg-white/40 rounded-full",initial:{width:"0%"},animate:{width:`${t}%`},transition:{duration:.3,ease:"easeOut"}})}),t>0&&s.jsxs(D.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},className:"text-white/40 text-xs mt-3 tracking-wider",children:[Math.round(t),"%"]})]})})})},ut=({ambientVolume:e,onAmbientVolumeChange:t,reducedMotion:r,onReducedMotionChange:i})=>{const[o,a]=n.useState(!1),[l,c]=n.useState(!1),u=0===e;return s.jsxs("div",{className:"absolute top-6 right-6 z-10",onKeyDown:e=>{"Escape"===e.key&&o&&(e.preventDefault(),a(!1))},children:[s.jsx(D.button,{className:"w-10 h-10 rounded-full bg-white/10 backdrop-blur-md\r\n                   border border-white/20 flex items-center justify-center\r\n                   focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50\r\n                   transition-all duration-300",animate:{opacity:o||l?1:.3},whileHover:{scale:1.05,opacity:1},whileTap:{scale:.95},onClick:()=>a(!o),onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),"aria-label":o?"Close settings":"Open settings","aria-expanded":o,"aria-controls":"settings-panel",children:o?s.jsx(rt,{className:"w-5 h-5 text-white/80"}):s.jsx(Ye,{className:"w-5 h-5 text-white/80"})}),s.jsx(L,{children:o&&s.jsxs(D.div,{id:"settings-panel",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2,ease:"easeOut"},className:"absolute top-14 right-0 w-72 bg-white/10 backdrop-blur-md\r\n                       border border-white/20 rounded-lg p-4 shadow-xl",role:"region","aria-label":"Settings panel",children:[s.jsx("h3",{className:"text-white text-sm font-light tracking-wide mb-4",children:"Settings"}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{htmlFor:"ambient-volume",className:"text-white/80 text-xs tracking-wide",children:"Ambient Audio"}),s.jsx("button",{onClick:()=>{t(u?.5:0)},className:"p-1 rounded hover:bg-white/10 transition-colors\r\n                           focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50","aria-label":u?"Unmute ambient audio":"Mute ambient audio",tabIndex:0,children:u?s.jsx(nt,{className:"w-4 h-4 text-white/60"}):s.jsx(tt,{className:"w-4 h-4 text-white/80"})})]}),s.jsx("input",{id:"ambient-volume",type:"range",min:"0",max:"1",step:"0.01",value:e,onChange:e=>t(parseFloat(e.target.value)),className:"w-full h-1 bg-white/20 rounded-lg appearance-none cursor-pointer\r\n                         [&::-webkit-slider-thumb]:appearance-none\r\n                         [&::-webkit-slider-thumb]:w-3\r\n                         [&::-webkit-slider-thumb]:h-3\r\n                         [&::-webkit-slider-thumb]:rounded-full\r\n                         [&::-webkit-slider-thumb]:bg-white\r\n                         [&::-webkit-slider-thumb]:cursor-pointer\r\n                         [&::-moz-range-thumb]:w-3\r\n                         [&::-moz-range-thumb]:h-3\r\n                         [&::-moz-range-thumb]:rounded-full\r\n                         [&::-moz-range-thumb]:bg-white\r\n                         [&::-moz-range-thumb]:border-0\r\n                         [&::-moz-range-thumb]:cursor-pointer","aria-label":"Ambient audio volume"}),s.jsxs("div",{className:"flex justify-between text-white/40 text-xs mt-1",children:[s.jsx("span",{children:"0%"}),s.jsxs("span",{children:[Math.round(100*e),"%"]}),s.jsx("span",{children:"100%"})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-4",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx(Ve,{className:"w-4 h-4 text-white/60 mr-2"}),s.jsx("h4",{className:"text-white/80 text-xs tracking-wide",children:"Accessibility"})]}),s.jsxs("label",{className:"flex items-center justify-between cursor-pointer group",children:[s.jsx("span",{className:"text-white/70 text-xs",children:"Reduce Motion"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:"checkbox",checked:r,onChange:e=>i(e.target.checked),className:"sr-only peer","aria-label":"Enable reduced motion"}),s.jsx("div",{className:"w-10 h-5 bg-white/20 rounded-full peer\r\n                               peer-checked:bg-blue-400/50\r\n                               peer-focus:ring-2 peer-focus:ring-white/40\r\n                               transition-colors duration-200"}),s.jsx("div",{className:"absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full\r\n                               peer-checked:translate-x-5\r\n                               transition-transform duration-200"})]})]}),s.jsx("p",{className:"text-white/40 text-xs mt-1 ml-0",children:"Simplifies animations for better accessibility"})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:s.jsxs("p",{className:"text-white/40 text-xs leading-relaxed",children:["Press ",s.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-white/60",children:"Space"})," or"," ",s.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-white/60",children:"Enter"})," to activate voice interaction."," ","Press ",s.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-white/60",children:"?"})," for more keyboard shortcuts."]})})]})})]})},dt=()=>{const[e,t]=n.useState(!1);return n.useEffect(()=>{const n=n=>{"?"!==n.key||e?"Escape"===n.key&&e&&(n.preventDefault(),t(!1)):(n.preventDefault(),t(!0))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[e]),s.jsxs(s.Fragment,{children:[s.jsx(D.button,{className:"absolute bottom-6 right-6 z-10 w-10 h-10 rounded-full \r\n                   bg-white/10 backdrop-blur-md border border-white/20 \r\n                   flex items-center justify-center\r\n                   focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50\r\n                   transition-all duration-300",whileHover:{scale:1.05,opacity:1},whileTap:{scale:.95},onClick:()=>t(!e),"aria-label":"Show keyboard shortcuts",title:"Keyboard shortcuts (?)",children:s.jsx(Ke,{className:"w-5 h-5 text-white/80"})}),s.jsx(L,{children:e&&s.jsxs(s.Fragment,{children:[s.jsx(D.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",onClick:()=>t(!1)}),s.jsxs(D.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2,ease:"easeOut"},className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-50\r\n                         w-full max-w-md bg-white/10 backdrop-blur-md\r\n                         border border-white/20 rounded-lg p-6 shadow-2xl",role:"dialog","aria-labelledby":"keyboard-help-title","aria-modal":"true",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h2",{id:"keyboard-help-title",className:"text-white text-lg font-light tracking-wide flex items-center gap-2",children:[s.jsx(Ke,{className:"w-5 h-5"}),"Keyboard Shortcuts"]}),s.jsx("button",{onClick:()=>t(!1),className:"p-1 rounded hover:bg-white/10 transition-colors\r\n                           focus:outline-none focus-visible:ring-2 focus-visible:ring-white/50","aria-label":"Close keyboard shortcuts",children:s.jsx(rt,{className:"w-5 h-5 text-white/80"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-white/90 text-sm font-medium mb-2",children:"Voice Interaction"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Start recording"}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Space"}),s.jsx("span",{className:"text-white/50",children:"or"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Enter"})]})]}),s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Stop recording"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Release key"})]}),s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Cancel recording"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Escape"})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-4",children:[s.jsx("h3",{className:"text-white/90 text-sm font-medium mb-2",children:"Navigation"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Move between elements"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Tab"})]}),s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Move backwards"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Shift + Tab"})]}),s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Activate button"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Enter"})]})]})]}),s.jsxs("div",{className:"border-t border-white/10 pt-4",children:[s.jsx("h3",{className:"text-white/90 text-sm font-medium mb-2",children:"Help"}),s.jsxs("ul",{className:"space-y-2 text-sm",children:[s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Show this help"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"?"})]}),s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-white/70",children:"Close dialogs"}),s.jsx("kbd",{className:"px-2 py-1 bg-white/10 rounded text-white/80 text-xs",children:"Escape"})]})]})]})]}),s.jsx("div",{className:"mt-6 pt-4 border-t border-white/10",children:s.jsxs("p",{className:"text-white/50 text-xs leading-relaxed",children:["All interactive elements can be accessed using keyboard navigation. Press ",s.jsx("kbd",{className:"px-1 py-0.5 bg-white/10 rounded text-white/60",children:"Tab"})," to move between elements."]})})]})]})})]})},mt=({capabilities:e,onRetry:t})=>{const n=(e=>e.supported?e.maxTextureSize&&e.maxTextureSize<2048?"Your graphics hardware does not meet the minimum requirements for this experience":"An unknown error occurred while initializing 3D graphics":e.error||"WebGL is not supported in your browser")(e),r=(()=>{const e=navigator.userAgent.toLowerCase(),t=[],n=e.includes("chrome")&&!e.includes("edge"),r=e.includes("firefox"),s=e.includes("safari")&&!e.includes("chrome"),i=e.includes("edge")||e.includes("edg/");return e.includes("trident")||e.includes("msie")?(t.push("Internet Explorer is not supported. Please use a modern browser."),t.push("Recommended browsers: Chrome, Firefox, Safari, or Edge")):s?(t.push("Make sure you are using Safari 15 or later"),t.push("Check that hardware acceleration is enabled in Safari preferences")):r?(t.push("Make sure you are using Firefox 90 or later"),t.push("Check that WebGL is enabled in about:config (webgl.disabled should be false)")):n||i?(t.push("Make sure you are using the latest version of your browser"),t.push("Check that hardware acceleration is enabled in browser settings"),t.push("Try visiting chrome://gpu to see if WebGL is blocked")):(t.push("Please use a modern browser such as Chrome, Firefox, Safari, or Edge"),t.push("Make sure your browser is up to date")),t.push("Update your graphics drivers to the latest version"),t.push("Try disabling browser extensions that might block WebGL"),t})();return s.jsx("div",{className:"fixed inset-0 bg-gradient-to-b from-[#0a1e3d] to-[#1e4d8b] flex items-center justify-center z-50 p-4",children:s.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-2xl w-full",children:[s.jsxs("div",{className:"bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl p-8 shadow-2xl",children:[s.jsx("div",{className:"flex justify-center mb-6",children:s.jsx("div",{className:"w-20 h-20 rounded-full bg-orange-500/20 flex items-center justify-center",children:s.jsx(et,{className:"w-10 h-10 text-orange-400"})})}),s.jsx("h1",{className:"text-3xl font-light text-white text-center mb-4 tracking-wide",children:"3D Experience Unavailable"}),s.jsx("p",{className:"text-white/80 text-center mb-8 text-lg",children:n}),null!==e.version&&s.jsxs("details",{className:"mb-6 bg-white/5 rounded-lg p-4",children:[s.jsx("summary",{className:"text-white/60 text-sm cursor-pointer hover:text-white/80 transition-colors",children:"Technical Details"}),s.jsxs("div",{className:"mt-4 space-y-2 text-sm text-white/60 font-mono",children:[s.jsxs("div",{children:["WebGL Version: ",e.version||"Not supported"]}),e.renderer&&s.jsxs("div",{children:["Renderer: ",e.renderer]}),e.vendor&&s.jsxs("div",{children:["Vendor: ",e.vendor]}),e.maxTextureSize&&s.jsxs("div",{children:["Max Texture Size: ",e.maxTextureSize,"px"]})]})]}),s.jsxs("div",{className:"bg-white/5 rounded-lg p-6 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Xe,{className:"w-5 h-5 text-blue-400"}),s.jsx("h2",{className:"text-white font-medium",children:"What can I do?"})]}),s.jsx("ul",{className:"space-y-3 text-white/70 text-sm",children:r.map((e,t)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-blue-400 mt-1",children:"•"}),s.jsx("span",{children:e})]},t))})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[t&&s.jsxs(D.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-400/30 rounded-lg text-white transition-colors",children:[s.jsx(Qe,{className:"w-4 h-4"}),s.jsx("span",{children:"Try Again"})]}),s.jsxs(D.a,{whileHover:{scale:1.05},whileTap:{scale:.95},href:"https://get.webgl.org/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-6 py-3 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-white transition-colors",children:[s.jsx(Xe,{className:"w-4 h-4"}),s.jsx("span",{children:"Learn More About WebGL"})]})]}),s.jsx("div",{className:"mt-8 pt-6 border-t border-white/10",children:s.jsxs("p",{className:"text-white/50 text-sm text-center",children:["You can still access Rose through our"," ",s.jsx("a",{href:"/text",className:"text-blue-400 hover:text-blue-300 underline transition-colors",children:"text-only interface"})]})})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx("p",{className:"text-white/40 text-xs",children:"Rose the Healer Shaman requires WebGL for the immersive 3D experience"})})]})})},ht=({children:e,enabled:t=!1})=>(((e={})=>{const{duration:t=1.2,easing:r=e=>Math.min(1,1.001-Math.pow(2,-10*e)),enabled:s=!0}=e,i=n.useRef(null),o=n.useRef(null);n.useEffect(()=>{if(!s)return;const e=new I({duration:t,easing:r});i.current=e;const n=t=>{e.raf(t),o.current=requestAnimationFrame(n)};return o.current=requestAnimationFrame(n),()=>{null!==o.current&&cancelAnimationFrame(o.current),i.current&&(i.current.destroy(),i.current=null)}},[t,r,s]),i.current})({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),enabled:t}),s.jsx(s.Fragment,{children:e}));
/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function pt(e,t){return function(){return e.apply(t,arguments)}}const{toString:ft}=Object.prototype,{getPrototypeOf:gt}=Object,{iterator:yt,toStringTag:xt}=Symbol,vt=(e=>t=>{const n=ft.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),wt=e=>(e=e.toLowerCase(),t=>vt(t)===e),bt=e=>t=>typeof t===e,{isArray:jt}=Array,St=bt("undefined");function kt(e){return null!==e&&!St(e)&&null!==e.constructor&&!St(e.constructor)&&Rt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Et=wt("ArrayBuffer");const Ct=bt("string"),Rt=bt("function"),Mt=bt("number"),Nt=e=>null!==e&&"object"==typeof e,At=e=>{if("object"!==vt(e))return!1;const t=gt(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||xt in e||yt in e)},Tt=wt("Date"),Pt=wt("File"),Ot=wt("Blob"),Dt=wt("FileList"),Lt=wt("URLSearchParams"),[It,Ft,zt,Ut]=["ReadableStream","Request","Response","Headers"].map(wt);function _t(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,s;if("object"!=typeof e&&(e=[e]),jt(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(kt(e))return;const s=n?Object.getOwnPropertyNames(e):Object.keys(e),i=s.length;let o;for(r=0;r<i;r++)o=s[r],t.call(null,e[o],o,e)}}function qt(e,t){if(kt(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r,s=n.length;for(;s-- >0;)if(r=n[s],t===r.toLowerCase())return r;return null}const Bt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Ht=e=>!St(e)&&e!==Bt;const Wt=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&gt(Uint8Array)),Gt=wt("HTMLFormElement"),Vt=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),Kt=wt("RegExp"),Jt=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};_t(n,(n,s)=>{let i;!1!==(i=t(n,s,e))&&(r[s]=i||n)}),Object.defineProperties(e,r)};const $t=wt("AsyncFunction"),Zt=(Xt="function"==typeof setImmediate,Qt=Rt(Bt.postMessage),Xt?setImmediate:Qt?(Yt=`axios@${Math.random()}`,en=[],Bt.addEventListener("message",({source:e,data:t})=>{e===Bt&&t===Yt&&en.length&&en.shift()()},!1),e=>{en.push(e),Bt.postMessage(Yt,"*")}):e=>setTimeout(e));var Xt,Qt,Yt,en;const tn="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Bt):"undefined"!=typeof process&&process.nextTick||Zt,nn={isArray:jt,isArrayBuffer:Et,isBuffer:kt,isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Rt(e.append)&&("formdata"===(t=vt(e))||"object"===t&&Rt(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Et(e.buffer),t},isString:Ct,isNumber:Mt,isBoolean:e=>!0===e||!1===e,isObject:Nt,isPlainObject:At,isEmptyObject:e=>{if(!Nt(e)||kt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(t){return!1}},isReadableStream:It,isRequest:Ft,isResponse:zt,isHeaders:Ut,isUndefined:St,isDate:Tt,isFile:Pt,isBlob:Ot,isRegExp:Kt,isFunction:Rt,isStream:e=>Nt(e)&&Rt(e.pipe),isURLSearchParams:Lt,isTypedArray:Wt,isFileList:Dt,forEach:_t,merge:function e(){const{caseless:t,skipUndefined:n}=Ht(this)&&this||{},r={},s=(s,i)=>{const o=t&&qt(r,i)||i;At(r[o])&&At(s)?r[o]=e(r[o],s):At(s)?r[o]=e({},s):jt(s)?r[o]=s.slice():n&&St(s)||(r[o]=s)};for(let i=0,o=arguments.length;i<o;i++)arguments[i]&&_t(arguments[i],s);return r},extend:(e,t,n,{allOwnKeys:r}={})=>(_t(t,(t,r)=>{n&&Rt(t)?e[r]=pt(t,n):e[r]=t},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let s,i,o;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)o=s[i],r&&!r(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&gt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:vt,kindOfTest:wt,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(jt(e))return e;let t=e.length;if(!Mt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[yt]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:Gt,hasOwnProperty:Vt,hasOwnProp:Vt,reduceDescriptors:Jt,freezeMethods:e=>{Jt(e,(t,n)=>{if(Rt(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Rt(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return jt(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:qt,global:Bt,isContextDefined:Ht,isSpecCompliantForm:function(e){return!!(e&&Rt(e.append)&&"FormData"===e[xt]&&e[yt])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Nt(e)){if(t.indexOf(e)>=0)return;if(kt(e))return e;if(!("toJSON"in e)){t[r]=e;const s=jt(e)?[]:{};return _t(e,(e,t)=>{const i=n(e,r+1);!St(i)&&(s[t]=i)}),t[r]=void 0,s}}return e};return n(e,0)},isAsyncFn:$t,isThenable:e=>e&&(Nt(e)||Rt(e))&&Rt(e.then)&&Rt(e.catch),setImmediate:Zt,asap:tn,isIterable:e=>null!=e&&Rt(e[yt])};function rn(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}nn.inherits(rn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:nn.toJSONObject(this.config),code:this.code,status:this.status}}});const sn=rn.prototype,on={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{on[e]={value:e}}),Object.defineProperties(rn,on),Object.defineProperty(sn,"isAxiosError",{value:!0}),rn.from=(e,t,n,r,s,i)=>{const o=Object.create(sn);nn.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const a=e&&e.message?e.message:"Error",l=null==t&&e?e.code:t;return rn.call(o,a,l,n,r,s),e&&null==o.cause&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",i&&Object.assign(o,i),o};function an(e){return nn.isPlainObject(e)||nn.isArray(e)}function ln(e){return nn.endsWith(e,"[]")?e.slice(0,-2):e}function cn(e,t,n){return e?e.concat(t).map(function(e,t){return e=ln(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const un=nn.toFlatObject(nn,{},null,function(e){return/^is[A-Z]/.test(e)});function dn(e,t,n){if(!nn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=nn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!nn.isUndefined(t[e])})).metaTokens,s=n.visitor||c,i=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&nn.isSpecCompliantForm(t);if(!nn.isFunction(s))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(nn.isDate(e))return e.toISOString();if(nn.isBoolean(e))return e.toString();if(!a&&nn.isBlob(e))throw new rn("Blob is not supported. Use a Buffer instead.");return nn.isArrayBuffer(e)||nn.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(nn.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(nn.isArray(e)&&function(e){return nn.isArray(e)&&!e.some(an)}(e)||(nn.isFileList(e)||nn.endsWith(n,"[]"))&&(a=nn.toArray(e)))return n=ln(n),a.forEach(function(e,r){!nn.isUndefined(e)&&null!==e&&t.append(!0===o?cn([n],r,i):null===o?n:n+"[]",l(e))}),!1;return!!an(e)||(t.append(cn(s,n,i),l(e)),!1)}const u=[],d=Object.assign(un,{defaultVisitor:c,convertValue:l,isVisitable:an});if(!nn.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!nn.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),nn.forEach(n,function(n,i){!0===(!(nn.isUndefined(n)||null===n)&&s.call(t,n,nn.isString(i)?i.trim():i,r,d))&&e(n,r?r.concat(i):[i])}),u.pop()}}(e),t}function mn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function hn(e,t){this._pairs=[],e&&dn(e,this,t)}const pn=hn.prototype;function fn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function gn(e,t,n){if(!t)return e;const r=n&&n.encode||fn;nn.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(i=s?s(t,n):nn.isURLSearchParams(t)?t.toString():new hn(t,n).toString(r),i){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}pn.append=function(e,t){this._pairs.push([e,t])},pn.toString=function(e){const t=e?function(t){return e.call(this,t,mn)}:mn;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};class yn{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){nn.forEach(this.handlers,function(t){null!==t&&e(t)})}}const xn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},vn={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:hn,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},wn="undefined"!=typeof window&&"undefined"!=typeof document,bn="object"==typeof navigator&&navigator||void 0,jn=wn&&(!bn||["ReactNative","NativeScript","NS"].indexOf(bn.product)<0),Sn="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,kn=wn&&window.location.href||"http://localhost",En={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:wn,hasStandardBrowserEnv:jn,hasStandardBrowserWebWorkerEnv:Sn,navigator:bn,origin:kn},Symbol.toStringTag,{value:"Module"})),...vn};function Cn(e){function t(e,n,r,s){let i=e[s++];if("__proto__"===i)return!0;const o=Number.isFinite(+i),a=s>=e.length;if(i=!i&&nn.isArray(r)?r.length:i,a)return nn.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!o;r[i]&&nn.isObject(r[i])||(r[i]=[]);return t(e,n,r[i],s)&&nn.isArray(r[i])&&(r[i]=function(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}(r[i])),!o}if(nn.isFormData(e)&&nn.isFunction(e.entries)){const n={};return nn.forEachEntry(e,(e,r)=>{t(function(e){return nn.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null}const Rn={transitional:xn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=nn.isObject(e);s&&nn.isHTMLForm(e)&&(e=new FormData(e));if(nn.isFormData(e))return r?JSON.stringify(Cn(e)):e;if(nn.isArrayBuffer(e)||nn.isBuffer(e)||nn.isStream(e)||nn.isFile(e)||nn.isBlob(e)||nn.isReadableStream(e))return e;if(nn.isArrayBufferView(e))return e.buffer;if(nn.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let i;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return dn(e,new En.classes.URLSearchParams,{visitor:function(e,t,n,r){return En.isNode&&nn.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)},...t})}(e,this.formSerializer).toString();if((i=nn.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return dn(i?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),function(e,t,n){if(nn.isString(e))try{return(t||JSON.parse)(e),nn.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Rn.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(nn.isResponse(e)||nn.isReadableStream(e))return e;if(e&&nn.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(s){if(n){if("SyntaxError"===s.name)throw rn.from(s,rn.ERR_BAD_RESPONSE,this,null,this.response);throw s}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:En.classes.FormData,Blob:En.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};nn.forEach(["delete","get","head","post","put","patch"],e=>{Rn.headers[e]={}});const Mn=nn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Nn=Symbol("internals");function An(e){return e&&String(e).trim().toLowerCase()}function Tn(e){return!1===e||null==e?e:nn.isArray(e)?e.map(Tn):String(e)}function Pn(e,t,n,r,s){return nn.isFunction(r)?r.call(this,t,n):(s&&(t=n),nn.isString(t)?nn.isString(r)?-1!==t.indexOf(r):nn.isRegExp(r)?r.test(t):void 0:void 0)}let On=class{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function s(e,t,n){const s=An(t);if(!s)throw new Error("header name must be a non-empty string");const i=nn.findKey(r,s);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=Tn(e))}const i=(e,t)=>nn.forEach(e,(e,n)=>s(e,n,t));if(nn.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(nn.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))i((e=>{const t={};let n,r,s;return e&&e.split("\n").forEach(function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!n||t[n]&&Mn[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(nn.isObject(e)&&nn.isIterable(e)){let n,r,s={};for(const t of e){if(!nn.isArray(t))throw TypeError("Object iterator must return a key-value pair");s[r=t[0]]=(n=s[r])?nn.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}i(s,t)}else null!=e&&s(t,e,n);return this}get(e,t){if(e=An(e)){const n=nn.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(nn.isFunction(t))return t.call(this,e,n);if(nn.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=An(e)){const n=nn.findKey(this,e);return!(!n||void 0===this[n]||t&&!Pn(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function s(e){if(e=An(e)){const s=nn.findKey(n,e);!s||t&&!Pn(0,n[s],s,t)||(delete n[s],r=!0)}}return nn.isArray(e)?e.forEach(s):s(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const s=t[n];e&&!Pn(0,this[s],s,e,!0)||(delete this[s],r=!0)}return r}normalize(e){const t=this,n={};return nn.forEach(this,(r,s)=>{const i=nn.findKey(n,s);if(i)return t[i]=Tn(r),void delete t[s];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(s):String(s).trim();o!==s&&delete t[s],t[o]=Tn(r),n[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return nn.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&nn.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach(e=>n.set(e)),n}static accessor(e){const t=(this[Nn]=this[Nn]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=An(e);t[r]||(!function(e,t){const n=nn.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,s){return this[r].call(this,t,e,n,s)},configurable:!0})})}(n,e),t[r]=!0)}return nn.isArray(e)?e.forEach(r):r(e),this}};function Dn(e,t){const n=this||Rn,r=t||n,s=On.from(r.headers);let i=r.data;return nn.forEach(e,function(e){i=e.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function Ln(e){return!(!e||!e.__CANCEL__)}function In(e,t,n){rn.call(this,null==e?"canceled":e,rn.ERR_CANCELED,t,n),this.name="CanceledError"}function Fn(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new rn("Request failed with status code "+n.status,[rn.ERR_BAD_REQUEST,rn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}On.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),nn.reduceDescriptors(On.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}}),nn.freezeMethods(On),nn.inherits(In,rn,{__CANCEL__:!0});const zn=(e,t,n=3)=>{let r=0;const s=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s,i=0,o=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),c=r[o];s||(s=l),n[i]=a,r[i]=l;let u=o,d=0;for(;u!==i;)d+=n[u++],u%=e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),l-s<t)return;const m=c&&l-c;return m?Math.round(1e3*d/m):void 0}}(50,250);return function(e,t){let n,r,s=0,i=1e3/t;const o=(t,i=Date.now())=>{s=i,n=null,r&&(clearTimeout(r),r=null),e(...t)};return[(...e)=>{const t=Date.now(),a=t-s;a>=i?o(e,t):(n=e,r||(r=setTimeout(()=>{r=null,o(n)},i-a)))},()=>n&&o(n)]}(n=>{const i=n.loaded,o=n.lengthComputable?n.total:void 0,a=i-r,l=s(a);r=i;e({loaded:i,total:o,progress:o?i/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&i<=o?(o-i)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},Un=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},_n=e=>(...t)=>nn.asap(()=>e(...t)),qn=En.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,En.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(En.origin),En.navigator&&/(msie|trident)/i.test(En.navigator.userAgent)):()=>!0,Bn=En.hasStandardBrowserEnv?{write(e,t,n,r,s,i){const o=[e+"="+encodeURIComponent(t)];nn.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),nn.isString(r)&&o.push("path="+r),nn.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Hn(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const Wn=e=>e instanceof On?{...e}:e;function Gn(e,t){t=t||{};const n={};function r(e,t,n,r){return nn.isPlainObject(e)&&nn.isPlainObject(t)?nn.merge.call({caseless:r},e,t):nn.isPlainObject(t)?nn.merge({},t):nn.isArray(t)?t.slice():t}function s(e,t,n,s){return nn.isUndefined(t)?nn.isUndefined(e)?void 0:r(void 0,e,0,s):r(e,t,0,s)}function i(e,t){if(!nn.isUndefined(t))return r(void 0,t)}function o(e,t){return nn.isUndefined(t)?nn.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,s,i){return i in t?r(n,s):i in e?r(void 0,n):void 0}const l={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t,n)=>s(Wn(e),Wn(t),0,!0)};return nn.forEach(Object.keys({...e,...t}),function(r){const i=l[r]||s,o=i(e[r],t[r],r);nn.isUndefined(o)&&i!==a||(n[r]=o)}),n}const Vn=e=>{const t=Gn({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:o,auth:a}=t;if(t.headers=o=On.from(o),t.url=gn(Hn(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),nn.isFormData(n))if(En.hasStandardBrowserEnv||En.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(nn.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(([e,n])=>{t.includes(e.toLowerCase())&&o.set(e,n)})}if(En.hasStandardBrowserEnv&&(r&&nn.isFunction(r)&&(r=r(t)),r||!1!==r&&qn(t.url))){const e=s&&i&&Bn.read(i);e&&o.set(s,e)}return t},Kn="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=Vn(e);let s=r.data;const i=On.from(r.headers).normalize();let o,a,l,c,u,{responseType:d,onUploadProgress:m,onDownloadProgress:h}=r;function p(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let f=new XMLHttpRequest;function g(){if(!f)return;const r=On.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Fn(function(e){t(e),p()},function(e){n(e),p()},{data:d&&"text"!==d&&"json"!==d?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:r,config:e,request:f}),f=null}f.open(r.method.toUpperCase(),r.url,!0),f.timeout=r.timeout,"onloadend"in f?f.onloadend=g:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(g)},f.onabort=function(){f&&(n(new rn("Request aborted",rn.ECONNABORTED,e,f)),f=null)},f.onerror=function(t){const r=new rn(t&&t.message?t.message:"Network Error",rn.ERR_NETWORK,e,f);r.event=t||null,n(r),f=null},f.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const s=r.transitional||xn;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new rn(t,s.clarifyTimeoutError?rn.ETIMEDOUT:rn.ECONNABORTED,e,f)),f=null},void 0===s&&i.setContentType(null),"setRequestHeader"in f&&nn.forEach(i.toJSON(),function(e,t){f.setRequestHeader(t,e)}),nn.isUndefined(r.withCredentials)||(f.withCredentials=!!r.withCredentials),d&&"json"!==d&&(f.responseType=r.responseType),h&&([l,u]=zn(h,!0),f.addEventListener("progress",l)),m&&f.upload&&([a,c]=zn(m),f.upload.addEventListener("progress",a),f.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(o=t=>{f&&(n(!t||t.type?new In(null,e,f):t),f.abort(),f=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);y&&-1===En.protocols.indexOf(y)?n(new rn("Unsupported protocol "+y+":",rn.ERR_BAD_REQUEST,e)):f.send(s||null)})},Jn=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const s=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof rn?t:new In(t instanceof Error?t.message:t))}};let i=t&&setTimeout(()=>{i=null,s(new rn(`timeout ${t} of ms exceeded`,rn.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)}),e=null)};e.forEach(e=>e.addEventListener("abort",s));const{signal:a}=r;return a.unsubscribe=()=>nn.asap(o),a}},$n=function*(e,t){let n=e.byteLength;if(n<t)return void(yield e);let r,s=0;for(;s<n;)r=s+t,yield e.slice(s,r),s=r},Zn=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Xn=(e,t,n,r)=>{const s=async function*(e,t){for await(const n of Zn(e))yield*$n(n,t)}(e,t);let i,o=0,a=e=>{i||(i=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await s.next();if(t)return a(),void e.close();let i=r.byteLength;if(n){let e=o+=i;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw a(t),t}},cancel:e=>(a(e),s.return())},{highWaterMark:2})},{isFunction:Qn}=nn,Yn=(({Request:e,Response:t})=>({Request:e,Response:t}))(nn.global),{ReadableStream:er,TextEncoder:tr}=nn.global,nr=(e,...t)=>{try{return!!e(...t)}catch(n){return!1}},rr=e=>{e=nn.merge.call({skipUndefined:!0},Yn,e);const{fetch:t,Request:n,Response:r}=e,s=t?Qn(t):"function"==typeof fetch,i=Qn(n),o=Qn(r);if(!s)return!1;const a=s&&Qn(er),l=s&&("function"==typeof tr?(e=>t=>e.encode(t))(new tr):async e=>new Uint8Array(await new n(e).arrayBuffer())),c=i&&a&&nr(()=>{let e=!1;const t=new n(En.origin,{body:new er,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),u=o&&a&&nr(()=>nn.isReadableStream(new r("").body)),d={stream:u&&(e=>e.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!d[e]&&(d[e]=(t,n)=>{let r=t&&t[e];if(r)return r.call(t);throw new rn(`Response type '${e}' is not supported`,rn.ERR_NOT_SUPPORT,n)})});const m=async(e,t)=>{const r=nn.toFiniteNumber(e.getContentLength());return null==r?(async e=>{if(null==e)return 0;if(nn.isBlob(e))return e.size;if(nn.isSpecCompliantForm(e)){const t=new n(En.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return nn.isArrayBufferView(e)||nn.isArrayBuffer(e)?e.byteLength:(nn.isURLSearchParams(e)&&(e+=""),nn.isString(e)?(await l(e)).byteLength:void 0)})(t):r};return async e=>{let{url:s,method:o,data:a,signal:l,cancelToken:h,timeout:p,onDownloadProgress:f,onUploadProgress:g,responseType:y,headers:x,withCredentials:v="same-origin",fetchOptions:w}=Vn(e),b=t||fetch;y=y?(y+"").toLowerCase():"text";let j=Jn([l,h&&h.toAbortSignal()],p),S=null;const k=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let E;try{if(g&&c&&"get"!==o&&"head"!==o&&0!==(E=await m(x,a))){let e,t=new n(s,{method:"POST",body:a,duplex:"half"});if(nn.isFormData(a)&&(e=t.headers.get("content-type"))&&x.setContentType(e),t.body){const[e,n]=Un(E,zn(_n(g)));a=Xn(t.body,65536,e,n)}}nn.isString(v)||(v=v?"include":"omit");const t=i&&"credentials"in n.prototype,l={...w,signal:j,method:o.toUpperCase(),headers:x.normalize().toJSON(),body:a,duplex:"half",credentials:t?v:void 0};S=i&&new n(s,l);let h=await(i?b(S,w):b(s,l));const p=u&&("stream"===y||"response"===y);if(u&&(f||p&&k)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=h[t]});const t=nn.toFiniteNumber(h.headers.get("content-length")),[n,s]=f&&Un(t,zn(_n(f),!0))||[];h=new r(Xn(h.body,65536,n,()=>{s&&s(),k&&k()}),e)}y=y||"text";let C=await d[nn.findKey(d,y)||"text"](h,e);return!p&&k&&k(),await new Promise((t,n)=>{Fn(t,n,{data:C,headers:On.from(h.headers),status:h.status,statusText:h.statusText,config:e,request:S})})}catch(C){if(k&&k(),C&&"TypeError"===C.name&&/Load failed|fetch/i.test(C.message))throw Object.assign(new rn("Network Error",rn.ERR_NETWORK,e,S),{cause:C.cause||C});throw rn.from(C,C&&C.code,e,S)}}},sr=new Map,ir=e=>{let t=e?e.env:{};const{fetch:n,Request:r,Response:s}=t,i=[r,s,n];let o,a,l=i.length,c=sr;for(;l--;)o=i[l],a=c.get(o),void 0===a&&c.set(o,a=l?new Map:rr(t)),c=a;return a};ir();const or={http:null,xhr:Kn,fetch:{get:ir}};nn.forEach(or,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}});const ar=e=>`- ${e}`,lr=e=>nn.isFunction(e)||null===e||!1===e,cr=(e,t)=>{e=nn.isArray(e)?e:[e];const{length:n}=e;let r,s;const i={};for(let o=0;o<n;o++){let n;if(r=e[o],s=r,!lr(r)&&(s=or[(n=String(r)).toLowerCase()],void 0===s))throw new rn(`Unknown adapter '${n}'`);if(s&&(nn.isFunction(s)||(s=s.get(t))))break;i[n||"#"+o]=s}if(!s){const e=Object.entries(i).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build"));throw new rn("There is no suitable adapter to dispatch the request "+(n?e.length>1?"since :\n"+e.map(ar).join("\n"):" "+ar(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return s};function ur(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new In(null,e)}function dr(e){ur(e),e.headers=On.from(e.headers),e.data=Dn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return cr(e.adapter||Rn.adapter,e)(e).then(function(t){return ur(e),t.data=Dn.call(e,e.transformResponse,t),t.headers=On.from(t.headers),t},function(t){return Ln(t)||(ur(e),t&&t.response&&(t.response.data=Dn.call(e,e.transformResponse,t.response),t.response.headers=On.from(t.response.headers))),Promise.reject(t)})}const mr="1.12.2",hr={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{hr[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const pr={};hr.transitional=function(e,t,n){return(r,s,i)=>{if(!1===e)throw new rn(function(e,t){return"[Axios v"+mr+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}(s," has been removed"+(t?" in "+t:"")),rn.ERR_DEPRECATED);return t&&!pr[s]&&(pr[s]=!0),!e||e(r,s,i)}},hr.spelling=function(e){return(e,t)=>!0};const fr={assertOptions:function(e,t,n){if("object"!=typeof e)throw new rn("options must be an object",rn.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],o=t[i];if(o){const t=e[i],n=void 0===t||o(t,i,e);if(!0!==n)throw new rn("option "+i+" must be "+n,rn.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new rn("Unknown option "+i,rn.ERR_BAD_OPTION)}},validators:hr},gr=fr.validators;let yr=class{constructor(e){this.defaults=e||{},this.interceptors={request:new yn,response:new yn}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(r){}}throw n}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Gn(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:s}=t;void 0!==n&&fr.assertOptions(n,{silentJSONParsing:gr.transitional(gr.boolean),forcedJSONParsing:gr.transitional(gr.boolean),clarifyTimeoutError:gr.transitional(gr.boolean)},!1),null!=r&&(nn.isFunction(r)?t.paramsSerializer={serialize:r}:fr.assertOptions(r,{encode:gr.function,serialize:gr.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),fr.assertOptions(t,{baseUrl:gr.spelling("baseURL"),withXsrfToken:gr.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&nn.merge(s.common,s[t.method]);s&&nn.forEach(["delete","get","head","post","put","patch","common"],e=>{delete s[e]}),t.headers=On.concat(i,s);const o=[];let a=!0;this.interceptors.request.forEach(function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let u,d=0;if(!a){const e=[dr.bind(this),void 0];for(e.unshift(...o),e.push(...l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=o.length;let m=t;for(;d<u;){const e=o[d++],t=o[d++];try{m=e(m)}catch(h){t.call(this,h);break}}try{c=dr.call(this,m)}catch(h){return Promise.reject(h)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return gn(Hn((e=Gn(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}};nn.forEach(["delete","get","head","options"],function(e){yr.prototype[e]=function(t,n){return this.request(Gn(n||{},{method:e,url:t,data:(n||{}).data}))}}),nn.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,s){return this.request(Gn(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}yr.prototype[e]=t(),yr.prototype[e+"Form"]=t(!0)});const xr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xr).forEach(([e,t])=>{xr[t]=e});const vr=function e(t){const n=new yr(t),r=pt(yr.prototype.request,n);return nn.extend(r,yr.prototype,n,{allOwnKeys:!0}),nn.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Gn(t,n))},r}(Rn);vr.Axios=yr,vr.CanceledError=In,vr.CancelToken=class e{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,s){n.reason||(n.reason=new In(e,r,s),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let t;return{token:new e(function(e){t=e}),cancel:t}}},vr.isCancel=Ln,vr.VERSION=mr,vr.toFormData=dn,vr.AxiosError=rn,vr.Cancel=vr.CanceledError,vr.all=function(e){return Promise.all(e)},vr.spread=function(e){return function(t){return e.apply(null,t)}},vr.isAxiosError=function(e){return nn.isObject(e)&&!0===e.isAxiosError},vr.mergeConfig=Gn,vr.AxiosHeaders=On,vr.formToJSON=e=>Cn(nn.isHTMLForm(e)?new FormData(e):e),vr.getAdapter=cr,vr.HttpStatusCode=xr,vr.default=vr;const{Axios:wr,AxiosError:br,CanceledError:jr,isCancel:Sr,CancelToken:kr,VERSION:Er,all:Cr,Cancel:Rr,isAxiosError:Mr,spread:Nr,toFormData:Ar,AxiosHeaders:Tr,HttpStatusCode:Pr,formToJSON:Or,getAdapter:Dr,mergeConfig:Lr}=vr,Ir="🔌 No internet connection. Please check your network and try again.",Fr="🔌 Cannot connect to Rose. Please ensure the server is running.",zr="⏱️ Request timed out. The server is taking too long to respond. Please try again.",Ur="❌ Server error occurred. Please try again in a moment.",_r="🎤 Microphone access denied. Please allow microphone access in your browser settings.",qr="🎤 No microphone found. Please connect a microphone and try again.",Br="🎤 Microphone is already in use by another application.",Hr="🎤 Microphone error. Please check your device and try again.",Wr="🎤 I couldn't hear that clearly. Could you try again?",Gr="🎤 Audio file is too large. Please record a shorter message.",Vr="🔊 Failed to play audio response. Please check your speakers.",Kr="🔊 Failed to load audio. Please try again.",Jr="⏱️ Your session has expired. Please refresh the page.",$r="⏱️ Session not found. Please refresh the page.",Zr="⏱️ Too many requests. Please wait a moment and try again.",Xr="🏥 Health check failed. The server may be down.",Qr="❌ An unexpected error occurred. Please try again.",Yr={[Ir]:{category:"connection",severity:"error",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},[Fr]:{category:"connection",severity:"critical",isTransient:!1,isDismissible:!0,retryable:!0,requiresRefresh:!1},[zr]:{category:"connection",severity:"warning",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},[_r]:{category:"microphone",severity:"error",isTransient:!1,isDismissible:!0,retryable:!1,requiresRefresh:!1},[qr]:{category:"microphone",severity:"error",isTransient:!1,isDismissible:!0,retryable:!1,requiresRefresh:!1},[Wr]:{category:"voice_processing",severity:"warning",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},[Gr]:{category:"voice_processing",severity:"warning",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},[Vr]:{category:"playback",severity:"error",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},[Jr]:{category:"session",severity:"error",isTransient:!1,isDismissible:!0,retryable:!1,requiresRefresh:!0},[Zr]:{category:"rate_limit",severity:"warning",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1},"❌ Failed to load critical assets. Please refresh the page.":{category:"asset",severity:"critical",isTransient:!1,isDismissible:!0,retryable:!1,requiresRefresh:!0}};function es(e){const t=function(e){return Yr[e]||{category:"generic",severity:"error",isTransient:!0,isDismissible:!0,retryable:!0,requiresRefresh:!1}}(e);return t.isTransient}const ts=new class{constructor(){t(this,"client");this.client=vr.create({baseURL:"/api/v1",timeout:6e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(e=>navigator.onLine?e:Promise.reject(new Error(Ir)),e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,e=>{if(e.message===Ir)throw new Error(Ir);if("ECONNABORTED"===e.code)throw new Error(zr);if(e.response){const t=e.response.status,n=e.response.data;if(401===t||403===t)throw new Error(Jr);if(413===t)throw new Error(Gr);if(429===t)throw new Error(Zr);if(t>=500)throw new Error(Ur);const r=n.detail||n.message||Ur;throw new Error(r)}throw e.request?new Error(Fr):new Error(Qr)})}async startSession(){return(await this.client.post("/session/start")).data}async processVoice(e,t){const n=new FormData;n.append("audio",e,"recording.webm"),n.append("session_id",t);return(await this.client.post("/voice/process",n,{headers:{"Content-Type":"multipart/form-data"}})).data}async checkHealth(){return(await this.client.get("/health")).data}},ns={defaultAudioUrl:"/assets/audio/ambient-ocean.mp3",defaultVolume:.25,duckingVolume:.08,fadeInDuration:2500,fadeOutDuration:1200,autoPlayDelay:800},rs={mimeType:{preferred:"audio/webm",fallbacks:["audio/mp4","audio/ogg"]},audioConstraints:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:1,latency:.01},timeslice:100,maxRecordingDuration:6e4,minRecordingDuration:500,retryAttempts:2,retryDelay:1e3,errorResetDelay:3e3},ss={fftSize:512,smoothingTimeConstant:.85,minDecibels:-85,maxDecibels:-15,noiseGate:.02},is=400,os=600,as="🎨",ls="🎭",cs="🎭",us="🎵",ds="📦",ms=[],hs=[],ps=e=>{const t=e.split(".").pop()?.toLowerCase();return"css"===t?as:"glb"===t||"gltf"===t?ls:"jpg"===t||"png"===t||"webp"===t?cs:"mp3"===t||"wav"===t||"ogg"===t?us:ds},fs=()=>{const[e,t]=n.useState(!0),[r,s]=n.useState(null),[i,o]=n.useState(0),a=()=>{t(!0),setTimeout(()=>{try{const e=(()=>{const e=document.createElement("canvas");let t=null,n=null;try{t=e.getContext("webgl2"),t&&(n=2)}catch(o){}if(!t)try{t=e.getContext("webgl")||e.getContext("experimental-webgl"),t&&(n=1)}catch(o){}if(!t||!n)return{supported:!1,version:null,renderer:null,vendor:null,maxTextureSize:null,error:"WebGL is not supported in your browser"};let r=null,s=null,i=null;try{const e=t.getExtension("WEBGL_debug_renderer_info");e&&(r=t.getParameter(e.UNMASKED_RENDERER_WEBGL),s=t.getParameter(e.UNMASKED_VENDOR_WEBGL)),i=t.getParameter(t.MAX_TEXTURE_SIZE)}catch(o){}try{t.clearColor(0,0,0,1),t.clear(t.COLOR_BUFFER_BIT)}catch(o){return{supported:!1,version:null,renderer:r,vendor:s,maxTextureSize:i,error:"WebGL context is not functional"}}return{supported:!0,version:n,renderer:r,vendor:s,maxTextureSize:i,error:null}})();s(e)}catch(e){s({supported:!1,version:null,renderer:null,vendor:null,maxTextureSize:null,error:"An error occurred while detecting WebGL support"})}finally{t(!1)}},100)};n.useEffect(()=>{a()},[i]);const l=!!r&&(e=>!(!e.supported||!e.version||e.maxTextureSize&&e.maxTextureSize<2048))(r);return{isSupported:l,isChecking:e,capabilities:r,retry:()=>{o(e=>e+1)}}};function gs(){const[e,t]=n.useState(!1),[r,i]=n.useState(""),[o,a]=n.useState(null),l=n.useRef(null),{isHealthy:c,error:u,version:d,isLoading:m}=(()=>{const[e,t]=n.useState(null),[r,s]=n.useState(null),[i,o]=n.useState(null),[a,l]=n.useState(!0);return n.useEffect(()=>{(async()=>{try{l(!0);const e=await ts.checkHealth();t(!0),o(e.version||null),s(null)}catch(e){const n=e instanceof Error?e.message:Xr;s(n),t(!1),o(null)}finally{l(!1)}})()},[]),{isHealthy:e,error:r,version:i,isLoading:a}})(),{isSupported:h,isChecking:p,capabilities:f,retry:g}=fs(),{isLoading:y,progress:x,error:v}=((e={})=>{const{enabled:t=!0,onProgress:r,onComplete:s,onError:i}=e,[o,a]=n.useState({loaded:0,total:0,percentage:0,phase:"critical",failedAssets:[],criticalAssetsFailed:!1}),[l,c]=n.useState(!0),[u,d]=n.useState(null),[m,h]=n.useState([]),p=ms.length+hs.length,f=n.useCallback((e,t,n,s,i)=>{const o=p>0?Math.round(e/p*100):0,l={loaded:e,total:p,percentage:o,phase:t,currentAsset:n,failedAssets:s,criticalAssetsFailed:i};a(l),r?.(l)},[p,r]);return n.useEffect(()=>{if(!t)return void c(!1);let e=0,n=!1;return(async()=>{try{const r=[];let i=!1;f(e,"critical","Loading essential scene elements...",r,i);for(const s of ms){if(n)return;try{ps(s),e++,f(e,"critical",s,r,i),await new Promise(e=>setTimeout(e,100))}catch(t){r.push(s),i=!0,h(e=>[...e,s])}}if(i)throw new Error(`Critical assets failed to load: ${r.join(", ")}`);if(n)return;f(e,"secondary","Loading environmental details...",r,i);for(const s of hs){if(n)return;try{ps(s),e++,f(e,"secondary",s,r,i),await new Promise(e=>setTimeout(e,100))}catch(t){r.push(s),h(e=>[...e,s])}}if(r.length,n)return;if(f(e,"effects","Preparing visual effects...",r,i),await new Promise(e=>setTimeout(e,200)),n)return;r.length,f(p,"complete","Ready",r,i),c(!1),s?.()}catch(t){if(!n){const e=t instanceof Error?t:new Error("Asset loading failed");d(e),c(!1),i?.(e)}}})(),()=>{n=!0}},[t,f,p,s,i]),{isLoading:l,progress:o,error:u,failedAssets:m}})({enabled:h,onProgress:e=>{},onComplete:()=>{},onError:e=>{a("Failed to load scene assets. Please refresh the page.")}});n.useEffect(()=>{u&&a(u)},[u,d]),n.useEffect(()=>{if(l.current&&(clearTimeout(l.current),l.current=null),o){const e=es(o)?5e3:null;null!==e&&(l.current=setTimeout(()=>{a(null),l.current=null},e))}return()=>{l.current&&(clearTimeout(l.current),l.current=null)}},[o]),n.useEffect(()=>{if(!1===c)return;if(null===c)return;(async()=>{try{const e=localStorage.getItem("rose_session_id");if(e)return void i(e);const t=await ts.startSession();i(t.session_id),localStorage.setItem("rose_session_id",t.session_id)}catch(e){a("Failed to connect to Rose. Please refresh the page.")}})()},[c]);const{voiceState:w,startRecording:b,stopRecording:j,audioElement:S,error:k}=(e=>{const{sessionId:t,onError:r,onResponseText:s}=e,[i,o]=n.useState("idle"),[a,l]=n.useState(null),[c,u]=n.useState(""),d=n.useRef(null),m=n.useRef([]),h=n.useRef(null),p=n.useRef(null),f=n.useCallback(async()=>{try{l(null),m.current=[];const e=await navigator.mediaDevices.getUserMedia({audio:rs.audioConstraints});h.current=e;const t=MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":MediaRecorder.isTypeSupported("audio/mp4")?"audio/mp4":"audio/ogg",n=new MediaRecorder(e,{mimeType:t});d.current=n,n.ondataavailable=e=>{e.data.size>0&&m.current.push(e.data)},n.onstop=async()=>{const e=new Blob(m.current,{type:t});h.current&&(h.current.getTracks().forEach(e=>e.stop()),h.current=null),await y(e)},n.start(),o("listening")}catch(e){let t=Hr;e instanceof Error&&("NotFoundError"===e.name?t=qr:"NotAllowedError"===e.name?t=_r:"NotReadableError"===e.name&&(t=Br)),l(t),o("idle"),r&&r(t)}},[t,r]),g=n.useCallback(()=>{d.current&&"listening"===i&&d.current.stop()},[i]),y=n.useCallback(async e=>{if(!t){const e=$r;return l(e),o("idle"),void(r&&r(e))}o("processing"),l(null);try{const n=await ts.processVoice(e,t);u(n.text),s&&s(n.text),await x(n.audio_url)}catch(n){const e=n instanceof Error?n.message:Wr;l(e),o("idle"),r&&r(e)}},[t,r,s]),x=n.useCallback(async e=>new Promise((t,n)=>{try{p.current&&(p.current.pause(),p.current=null);const s=new Audio(e);p.current=s,s.onplay=()=>{o("speaking")},s.onended=()=>{o("idle"),p.current=null,t()},s.onerror=e=>{const t=Vr;l(t),o("idle"),p.current=null,r&&r(t),n(new Error(t))},s.play().catch(e=>{const t=Vr;l(t),o("idle"),r&&r(t),n(e)})}catch(s){const e=Kr;l(e),o("idle"),r&&r(e),n(s)}}),[r]),v=n.useCallback(()=>{p.current&&(p.current.pause(),p.current=null,o("idle"))},[]),w=n.useCallback(()=>{d.current&&"listening"===i&&(d.current.stop(),m.current=[],h.current&&(h.current.getTracks().forEach(e=>e.stop()),h.current=null),o("idle"))},[i]);return n.useEffect(()=>()=>{h.current&&h.current.getTracks().forEach(e=>e.stop()),p.current&&p.current.pause()},[]),{voiceState:i,error:a,responseText:c,startRecording:f,stopRecording:g,cancelRecording:w,stopAudio:v,isListening:"listening"===i,isProcessing:"processing"===i,isSpeaking:"speaking"===i,isIdle:"idle"===i,audioElement:p.current}})({sessionId:r,onError:e=>a(e)}),{amplitude:E}=((e,t={})=>{const{fftSize:r=ss.fftSize,smoothingTimeConstant:s=ss.smoothingTimeConstant,minDecibels:i=ss.minDecibels,maxDecibels:o=ss.maxDecibels,enabled:a=!0}=t,[l,c]=n.useState({amplitude:0,frequency:0,frequencyData:new Uint8Array(0),waveformData:new Uint8Array(0)}),u=n.useRef(null),d=n.useRef(null),m=n.useRef(null),h=n.useRef(null),p=n.useRef(!1),f=n.useCallback(()=>{if(e&&a&&!p.current)try{const t=new(window.AudioContext||window.webkitAudioContext);u.current=t;const n=t.createAnalyser();n.fftSize=r,n.smoothingTimeConstant=s,n.minDecibels=i,n.maxDecibels=o,d.current=n;const a=t.createMediaElementSource(e);m.current=a,a.connect(n),n.connect(t.destination),p.current=!0,y()}catch(t){}},[e,a,r,s,i,o]),g=n.useCallback(()=>{if(!d.current||!a)return;const e=d.current,t=e.frequencyBinCount,n=new Uint8Array(t),r=new Uint8Array(t);e.getByteFrequencyData(n),e.getByteTimeDomainData(r);let s=n.reduce((e,t)=>e+t,0)/t/255;s<ss.noiseGate&&(s=0);let i=0,o=0;for(let a=0;a<t;a++)n[a]>i&&(i=n[a],o=a);const l=(u.current?.sampleRate||44100)/2;c({amplitude:s,frequency:o/t*l,frequencyData:n,waveformData:r}),h.current=requestAnimationFrame(g)},[a]),y=n.useCallback(()=>{h.current&&cancelAnimationFrame(h.current),h.current=requestAnimationFrame(g)},[g]),x=n.useCallback(()=>{h.current&&(cancelAnimationFrame(h.current),h.current=null)},[]);return n.useEffect(()=>{if(e&&a&&!p.current){const t=()=>{f()};if(!(e.readyState>=2))return e.addEventListener("canplay",t),()=>{e.removeEventListener("canplay",t)};f()}},[e,a,f]),n.useEffect(()=>()=>{x(),u.current&&(u.current.close(),u.current=null),p.current=!1},[x]),{amplitude:l.amplitude,frequency:l.frequency,frequencyData:l.frequencyData,waveformData:l.waveformData,startAnalysis:y,stopAnalysis:x,isAnalyzing:null!==h.current}})(S),{volume:C,setVolume:R,duck:M,unduck:N}=((e={})=>{const{audioUrl:t=ns.defaultAudioUrl,defaultVolume:r=ns.defaultVolume,duckingVolume:s=ns.duckingVolume,fadeInDuration:i=ns.fadeInDuration,fadeOutDuration:o=ns.fadeOutDuration,enabled:a=!0}=e,[l,c]=n.useState(!1),[u,d]=n.useState(r),[m,h]=n.useState(!1),[p,f]=n.useState(null),g=n.useRef(null),y=n.useRef(null),x=n.useCallback(()=>{if(a&&!g.current)try{const e=new Audio(t);e.loop=!0,e.volume=0,e.preload="auto",g.current=e,e.onerror=e=>{f("Failed to load ambient audio")},e.oncanplaythrough=()=>{f(null)}}catch(e){f("Failed to initialize ambient audio")}},[a,t]),v=n.useCallback((e,t)=>{if(!g.current)return;y.current&&clearInterval(y.current);const n=g.current,r=n.volume,s=t/50,i=(e-r)/50;let o=0;y.current=window.setInterval(()=>{o++,o>=50?(n.volume=e,y.current&&(clearInterval(y.current),y.current=null)):n.volume=r+i*o},s)},[]),w=n.useCallback(()=>{g.current&&a&&g.current.play().then(()=>{c(!0),v(u,i)}).catch(e=>{f("Failed to play ambient audio")})},[a,u,i,v]),b=n.useCallback(()=>{g.current&&(v(0,o),setTimeout(()=>{g.current&&(g.current.pause(),c(!1))},o))},[o,v]),j=n.useCallback(e=>{const t=Math.max(0,Math.min(1,e));d(t),g.current&&l&&!m&&v(t,300)},[l,m,v]),S=n.useCallback(()=>{g.current&&l&&(h(!0),v(s,is))},[l,s,v]),k=n.useCallback(()=>{g.current&&l&&(h(!1),v(u,os))},[l,u,v]),E=n.useCallback(()=>{l?b():w()},[l,w,b]);return n.useEffect(()=>{a&&x()},[a,x]),n.useEffect(()=>{if(a&&g.current&&!l){const e=setTimeout(()=>{w()},ns.autoPlayDelay);return()=>clearTimeout(e)}},[a,w,l]),n.useEffect(()=>()=>{y.current&&clearInterval(y.current),g.current&&(g.current.pause(),g.current=null)},[]),{isPlaying:l,volume:u,isDucking:m,error:p,play:w,stop:b,toggle:E,setVolume:j,duck:S,unduck:k,audioElement:g.current}})({enabled:!0});return n.useEffect(()=>{"listening"===w||"processing"===w||"speaking"===w?M():N()},[w,M,N]),n.useEffect(()=>{const e=window.matchMedia("(prefers-reduced-motion: reduce)");t(e.matches);const n=e=>{t(e.matches)};return e.addEventListener("change",n),()=>e.removeEventListener("change",n)},[]),n.useEffect(()=>{v&&a(v.message)},[v]),n.useEffect(()=>{const e=e=>{if(!(e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLButtonElement))switch(e.key){case" ":case"Enter":e.preventDefault(),"idle"!==w||o||b();break;case"Escape":e.preventDefault(),"listening"===w&&j()}},t=e=>{e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLButtonElement||" "!==e.key&&"Enter"!==e.key||"listening"!==w||(e.preventDefault(),j())};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t)}},[w,b,j,o]),p||h||!f?s.jsx(ht,{enabled:!1,children:s.jsxs("div",{className:"relative w-full h-screen overflow-hidden bg-gradient-to-b from-[#0a1e3d] to-[#1e4d8b]",children:[s.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-white focus:text-black",children:"Skip to main content"}),s.jsx(ct,{isLoading:y||p||m,progress:x.percentage,currentAsset:x.currentAsset,phase:x.phase}),(o||k)&&!y&&s.jsx("div",{className:"absolute top-24 left-1/2 -translate-x-1/2 z-20 max-w-md px-4",children:s.jsxs("div",{className:"bg-red-500/20 backdrop-blur-md border border-red-500/30 rounded-lg p-4 relative",children:[s.jsx("p",{className:"text-white text-sm text-center pr-8",children:o||k}),s.jsx("button",{onClick:()=>{a(null)},className:"absolute top-2 right-2 text-white/70 hover:text-white transition-colors","aria-label":"Dismiss error",children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),o&&es(o)&&s.jsx("p",{className:"text-white/50 text-xs text-center mt-2",children:"Auto-dismissing in 5 seconds..."})]})}),!y&&r&&s.jsx(n.Suspense,{fallback:null,children:s.jsx(ze,{voiceState:w,audioAmplitude:E,reducedMotion:e})}),!y&&s.jsxs("div",{id:"main-content",role:"main",children:[s.jsx(Ue,{}),s.jsx(lt,{voiceState:w,onStartRecording:b,onStopRecording:j,audioAmplitude:E,disabled:!r||!!o}),s.jsx(ut,{ambientVolume:C,onAmbientVolumeChange:R,reducedMotion:e,onReducedMotionChange:t}),s.jsx(dt,{})]})]})}):s.jsx(mt,{capabilities:f,onRetry:g})}f.createRoot(document.getElementById("root")).render(s.jsx(r.StrictMode,{children:s.jsx(ht,{enabled:!1,children:s.jsx(gs,{})})}));
